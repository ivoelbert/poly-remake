(this["webpackJsonppoly-remake"]=this["webpackJsonppoly-remake"]||[]).push([[4],{46:function(e,t,i){"use strict";i.r(t);var s=i(0),o=i(17),n=i(24),r=i(19),a=i(20),h=i(43),c=(new n.D,function(e,t){for(var i=0;i<e;i++)t(i)}),d=n.n;function l(e,t){return Math.random()*(t-e)+e}var u=function(){return new n.D(l(-1,1),l(-1,1),l(-1,1)).normalize()},p=function(e){return l(0,1)<e},v=function(){return new n.D(5e3,5e3,5e3)},f=function(e){return void 0===e||null===e},m=function(e,t){if(f(e))throw new b(t);return e},b=function(e){Object(r.a)(i,e);var t=Object(a.a)(i);function i(e){return Object(o.a)(this,i),t.call(this,null!==e&&void 0!==e?e:"Unexpected nil value!")}return i}(Object(h.a)(Error)),w=function(){},j=function(e){return e.values().next().value},O=function e(){var t=this;Object(o.a)(this,e),this.mesh=void 0,this.createStarsGeometry=function(){var e=new n.d,t=[];return c(1e3,(function(e){var i=d.randFloat(100,500);t.push(d.randFloat(-1,1)*i,d.randFloat(-1,1)*i,d.randFloat(-1,1)*i)})),e.setAttribute("position",new n.j(t,3)),e},this.mesh=new n.l,[new n.t({color:5592405,size:2,sizeAttenuation:!1}),new n.t({color:5592405,size:1,sizeAttenuation:!1}),new n.t({color:3355443,size:2,sizeAttenuation:!1}),new n.t({color:3815994,size:1,sizeAttenuation:!1}),new n.t({color:1710618,size:2,sizeAttenuation:!1}),new n.t({color:1710618,size:1,sizeAttenuation:!1})].forEach((function(e){var i=t.createStarsGeometry(),s=new n.s(i,e);s.matrixAutoUpdate=!1,s.updateMatrix(),t.mesh.add(s)}))},g=function e(t,i){var s=this;Object(o.a)(this,e),this.followedObject=t,this.shape=void 0,this.hitboxDebug=void 0,this.debug=function(e){var t=new n.y(s.shape.radius,8,6),i=new n.p({color:3296424,wireframe:!0});s.hitboxDebug=new n.o(t,i),e.add(s.hitboxDebug),s.update()},this.update=function(){var e=s.followedObject.position.clone();s.shape.center.copy(e),f(s.hitboxDebug)||s.hitboxDebug.position.copy(e)},this.intersects=function(e){return s.shape.intersectsSphere(e.shape)};var r=i.clone();r.computeBoundingSphere(),this.shape=m(r.boundingSphere),this.hitboxDebug=null,this.update()},y=function e(){Object(o.a)(this,e),this.shape=new n.x(v(),0),this.intersects=function(e){return!1}};function k(e,t,i,s,o){return n.n.mapLinear(e,t,i,s,o)}function x(e){return function(e,t,i){return e<t?t:e>i?i:e}(e,0,1)}var S,E=function e(t){var i=this;Object(o.a)(this,e),this.clock=t,this.mesh=void 0,this.hitbox=void 0,this.update=function(){var e=i.clock.getElapsed(),t=k(Math.sin(10*e),-1,1,.99,1.01);i.mesh.scale.set(t,t,t)},this.mesh=new n.l;var s=new n.y(5,16,12),r=new n.p({color:16395051,wireframe:!0}),a=new n.o(s,r);this.mesh.add(a),this.hitbox=new g(this.mesh,s)},D=i(26);!function(e){e.up="up",e.down="down",e.left="left",e.right="right",e.forwards="forwards",e.backwards="backwards",e.rollLeft="rollLeft",e.rollRight="rollRight",e.shoot="shoot"}(S||(S={}));var M=function(){var e;return e={},Object(D.a)(e,S.up,0),Object(D.a)(e,S.down,0),Object(D.a)(e,S.left,0),Object(D.a)(e,S.right,0),Object(D.a)(e,S.forwards,0),Object(D.a)(e,S.backwards,0),Object(D.a)(e,S.rollLeft,0),Object(D.a)(e,S.rollRight,0),Object(D.a)(e,S.shoot,0),e},G=function e(){var t=this;Object(o.a)(this,e),this.moveState=void 0,this.keyMapping=void 0,this.bindKey=function(e,i){t.keyMapping.set(e,i),t.moveState=M()},this.attachListeners=function(){window.addEventListener("keydown",t.keyDownHandler),window.addEventListener("keyup",t.keyUpHandler)},this.dispose=function(){window.addEventListener("keydown",t.keyDownHandler),window.addEventListener("keyup",t.keyUpHandler)},this.keyDownHandler=function(e){var i=t.keyMapping.get(e.code);f(i)||(t.moveState[i]=1)},this.keyUpHandler=function(e){var i=t.keyMapping.get(e.code);f(i)||(t.moveState[i]=0)},this.moveState=M(),this.keyMapping=function(){var e=new Map;return e.set("KeyW",S.up),e.set("KeyS",S.down),e.set("KeyA",S.left),e.set("KeyD",S.right),e.set("KeyI",S.forwards),e.set("KeyK",S.backwards),e.set("KeyJ",S.rollLeft),e.set("KeyL",S.rollRight),e.set("Space",S.shoot),e}()},z=function e(){var t=this;Object(o.a)(this,e),this.clock=void 0,this.delta=void 0,this.elapsed=void 0,this.getDelta=function(){return t.delta},this.getElapsed=function(){return t.elapsed},this.tick=function(){t.delta=t.clock.getDelta(),t.elapsed=t.clock.getElapsedTime()},this.clock=new n.e,this.delta=0,this.elapsed=0},A=function e(t,i,s,r){var a=this;Object(o.a)(this,e),this.controls=t,this.object=i,this.shots=s,this.clock=r,this.moveState=void 0,this.shotDelta=void 0,this.orbitSpeed=void 0,this.rollSpeed=void 0,this.forwardsAndBackwardsSpeed=void 0,this.inertiaFactor=void 0,this.shotRecoveryTime=void 0,this.update=function(){a.moveState=function(e,t,i){var s;return s={},Object(D.a)(s,S.up,d.lerp(e[S.up],t[S.up],i)),Object(D.a)(s,S.down,d.lerp(e[S.down],t[S.down],i)),Object(D.a)(s,S.left,d.lerp(e[S.left],t[S.left],i)),Object(D.a)(s,S.right,d.lerp(e[S.right],t[S.right],i)),Object(D.a)(s,S.forwards,d.lerp(e[S.forwards],t[S.forwards],i)),Object(D.a)(s,S.backwards,d.lerp(e[S.backwards],t[S.backwards],i)),Object(D.a)(s,S.rollLeft,d.lerp(e[S.rollLeft],t[S.rollLeft],i)),Object(D.a)(s,S.rollRight,d.lerp(e[S.rollRight],t[S.rollRight],i)),Object(D.a)(s,S.shoot,t[S.shoot]),s}(a.moveState,a.controls.moveState,a.inertiaFactor),a.updateDepth(),a.updateOrbit(),a.updateShots()},this.updateDepth=function(){var e=a.moveState[S.backwards]-a.moveState[S.forwards];if(Math.abs(e)>1e-5){var t=e*a.forwardsAndBackwardsSpeed,i=a.object.position.length();i+t<15?i=15:i+t>50?i=50:i+=t,a.object.position.setLength(i)}},this.updateOrbit=function(){var e=new n.D,t=new n.D,i=new n.D;a.object.matrix.extractBasis(e,t,i);var s=a.moveState[S.up]-a.moveState[S.down],o=a.moveState[S.right]-a.moveState[S.left],r=e.clone();r.multiplyScalar(s);var h=t.clone();h.multiplyScalar(o);var c=(new n.D).addVectors(r,h).clampLength(0,1),d=c.length();d>1e-5&&(c.normalize(),a.object.position.applyAxisAngle(c,d*a.orbitSpeed));var l=a.moveState[S.rollRight]-a.moveState[S.rollLeft];t.applyAxisAngle(i,l*a.rollSpeed),a.object.up.copy(t),a.object.lookAt(0,0,0)},this.updateShots=function(){a.shotDelta+=a.clock.getDelta(),a.shotDelta>a.shotRecoveryTime&&1===a.moveState[S.shoot]&&(a.shotDelta=0,a.shots.spawn(a.object.position))},this.moveState=M(),this.shotDelta=0,this.orbitSpeed=.05,this.rollSpeed=.05,this.forwardsAndBackwardsSpeed=.5,this.inertiaFactor=.1,this.shotRecoveryTime=.15,this.update()},R=function e(){var t=this;Object(o.a)(this,e),this.mesh=void 0,this.hitbox=void 0,this.update=function(){t.hitbox.update()},this.onCollide=function(e){console.log("OH SHIT!")},this.createGeometry=function(){var e=new n.d,t=[0,0,1],i=[0,.25,0],s=[-.5,-.25,0],o=[.5,-.25,0],r=new Float32Array([].concat(t,i,s,t,i,o,t,s,o,i,s,o));return e.setAttribute("position",new n.c(r,3)),e};var i=this.createGeometry(),s=new n.p({color:16448250,wireframe:!0});this.mesh=new n.o(i,s),this.mesh.position.set(0,0,50),this.hitbox=new g(this.mesh,i)},F=function(e){Object(r.a)(i,e);var t=Object(a.a)(i);function i(e){var s;return Object(o.a)(this,i),(s=t.call(this,75,window.innerWidth/window.innerHeight,.1,1e3)).followedObject=e,s.distance=void 0,s.inertiaFactor=void 0,s.update=function(){var e=s.followedObject.position.clone();e.add(e.clone().normalize().multiplyScalar(s.distance));var t=(new n.D).lerpVectors(s.position,e,s.inertiaFactor);s.position.copy(t),s.up.copy(s.followedObject.up),s.lookAt(0,0,0)},s.distance=2,s.inertiaFactor=.8,s.update(),s}return i}(n.r),L=i(33),H=i(45),I=i(44),C=1.01,T=1.1,P=0,K=0,V=function e(t,i){var s=this;Object(o.a)(this,e),this.renderer=void 0,this.composer=void 0,this.getDomElement=function(){return s.renderer.domElement},this.resize=function(){s.renderer.setSize(window.innerWidth,window.innerHeight),s.composer.setSize(window.innerWidth,window.innerHeight)},this.render=function(){s.composer.render()},this.renderer=new n.F,this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.toneMappingExposure=Math.pow(C,4),this.renderer.outputEncoding=n.G;var r=new L.a(t,i),a=new H.a(new n.C(window.innerWidth,window.innerHeight),T,K,P);this.composer=new I.a(this.renderer),this.composer.renderToScreen=!1,this.composer.addPass(r),this.composer.addPass(a),this.composer.renderToScreen=!0},W=i(25);function B(e){return"geometry"in e&&"material"in e}var U=function e(){var t=this;Object(o.a)(this,e),this.scene=void 0,this.add=function(){var e;return(e=t.scene).add.apply(e,arguments)},this.remove=function(){var e;return(e=t.scene).remove.apply(e,arguments)},this.dispose=function(){t.scene.traverse((function(e){e&&(B(e)&&(e.geometry&&e.geometry.dispose(),function(e){if(B(e)){var t,i=[].concat(e.material),s=Object(W.a)(i);try{for(s.s();!(t=s.n()).done;){t.value.dispose()}}catch(o){s.e(o)}finally{s.f()}}}(e)),Promise.resolve().then((function(){e.parent&&e.parent.remove(e)})))}))},this.scene=new n.v,this.scene.fog=new n.k(0,25e-6);var i=new n.b(16777215);this.scene.add(i)},J=function e(t,i,s,r){var a=this;Object(o.a)(this,e),this.clock=i,this.explosions=s,this.dropObject=r,this.mesh=void 0,this.hitbox=void 0,this.normal=void 0,this.angularVelocity=void 0,this.radialVelocity=void 0,this.epoch=void 0,this.spawn=function(e,t){a.mesh.position.copy(e),a.normal=t,a.epoch=a.clock.getElapsed()},this.onCollide=function(e){a.drop()},this.update=function(){var e=a.clock.getDelta(),t=function(e){var t=2*Math.PI/3;return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*t)+1}(x(k(a.clock.getElapsed()-a.epoch,0,1,0,1)));a.mesh.scale.set(t,t,t);var i=a.angularVelocity*e;a.mesh.position.applyAxisAngle(a.normal,i);var s=a.mesh.position.length(),o=a.radialVelocity*e;a.mesh.position.setLength(s+o),a.hitbox.update(),a.mesh.position.length()>50&&a.drop()},this.drop=function(){a.explosions.spawn(a.mesh.position.clone()),a.dropObject(a)},this.mesh=t.buildMesh(),this.hitbox=new g(this.mesh,t.getHitboxGeometry()),this.normal=new n.D(0,1,0),this.angularVelocity=1,this.radialVelocity=1,this.epoch=0};var X,Y=function e(){var t=this;Object(o.a)(this,e),this.mesh=void 0,this.hitboxGeometry=void 0,this.buildMesh=function(){return t.mesh.clone()},this.getHitboxGeometry=function(){return t.hitboxGeometry.clone()},this.hitboxGeometry=new n.i(1.5);var i=new n.p({color:2882091,wireframe:!0});this.mesh=new n.o(this.hitboxGeometry,i)},q=i(4);!function(e){e[e.asteroids=0]="asteroids",e[e.ship=1]="ship",e[e.shots=2]="shots",e[e.missiles=3]="missiles",e[e.center=4]="center"}(X||(X={}));var N=function e(){var t,i=this;Object(o.a)(this,e),this.rules=void 0,this.groups=void 0,this.addRule=function(e,t){i.rules.add([e,t])},this.addObjectToGroup=function(e,t){i.groups[t].add(e)},this.removeObjectFromGroup=function(e,t){i.groups[t].delete(e)},this.update=function(){i.rules.forEach((function(e){var t=Object(q.a)(e,2),s=t[0],o=t[1];i.groups[s].forEach((function(e){i.groups[o].forEach((function(t){var i,s;Z(e,t)&&(null===(i=e.onCollide)||void 0===i||i.call(e,t),null===(s=t.onCollide)||void 0===s||s.call(t,e))}))}))}))},this.rules=new Set,this.groups=(t={},Object(D.a)(t,X.asteroids,new Set),Object(D.a)(t,X.ship,new Set),Object(D.a)(t,X.shots,new Set),Object(D.a)(t,X.missiles,new Set),Object(D.a)(t,X.center,new Set),t)},Z=function(e,t){return e.hitbox.intersects(t.hitbox)},Q=function e(t,i,s,r){var a=this;Object(o.a)(this,e),this.scene=t,this.collider=i,this.clock=s,this.explosions=r,this.idleObjects=void 0,this.liveObjects=void 0,this.intervalId=void 0,this.start=function(){a.intervalId=setInterval(a.spawnRandom,3e3)},this.spawn=function(e,t){var i=m(j(a.idleObjects));a.idleObjects.delete(i),a.liveObjects.add(i),i.spawn(e,t),a.collider.addObjectToGroup(i,X.asteroids)},this.drop=function(e){e.mesh.position.copy(v()),a.liveObjects.delete(e),a.idleObjects.add(e),a.collider.removeObjectFromGroup(e,X.asteroids)},this.update=function(){a.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){a.liveObjects.forEach((function(e){return a.scene.remove(e.mesh)})),a.idleObjects.forEach((function(e){return a.scene.remove(e.mesh)})),null!==a.intervalId&&clearTimeout(a.intervalId)},this.spawnRandom=function(){var e=u(),t=function(e){var t=new n.D(1,0,0),i=[new n.D(0,1,0),new n.D(0,0,1)].reduce((function(t,i){return e.dot(t)>e.dot(i)?i:t}),t);return p(.5)&&i.negate(),(new n.D).crossVectors(e,i)}(e).setLength(5);a.spawn(t,e)},this.idleObjects=new Set,this.liveObjects=new Set;var h=new Y;c(50,(function(e){var t=new J(h,a.clock,a.explosions,a.drop);t.mesh.position.copy(v()),a.idleObjects.add(t)})),this.idleObjects.forEach((function(e){return a.scene.add(e.mesh)})),this.intervalId=null},$=function e(t,i,s,r,a){var h=this;Object(o.a)(this,e),this.object=t,this.clock=i,this.explosions=s,this.dropObject=a,this.mesh=void 0,this.hitbox=void 0,this.direction=void 0,this.angSpeed=void 0,this.speed=void 0,this.epoch=void 0,this.spawn=function(e,t){h.epoch=h.clock.getElapsed(),h.mesh.position.copy(e),h.direction.copy(t),h.direction.normalize(),h.align()},this.update=function(){h.updateRotation(),h.updatePosition(),h.updateFlames(),h.hitbox.update(),h.clock.getElapsed()-h.epoch>7&&h.drop()},this.onCollide=function(e){h.drop()},this.updateRotation=function(){var e=h.clock.getDelta(),t=h.object.position.clone();t.sub(h.mesh.position);var i=h.direction.angleTo(t),s=d.clamp(i,-h.angSpeed*e,h.angSpeed*e),o=(new n.D).crossVectors(t,h.direction);o.normalize(),h.direction.applyAxisAngle(o,-s),h.align()},this.updatePosition=function(){var e=h.clock.getDelta(),t=h.direction.clone();t.multiplyScalar(h.speed*e),h.mesh.position.add(t)},this.updateFlames=function(){var e=h.clock.getDelta(),t=h.clock.getElapsed();h.mesh.children[0].scale.y+=.05*Math.sin(10*t),h.mesh.children[0].rotateY(10*e),h.mesh.children[1].scale.y-=.05*Math.cos(10*t),h.mesh.children[1].rotateY(10*e)},this.align=function(){var e=h.mesh.position.clone();e.add(h.direction),h.mesh.lookAt(e),h.mesh.rotateOnAxis(new n.D(1,0,0),.5*Math.PI)},this.drop=function(){h.explosions.spawn(h.mesh.position.clone()),h.dropObject(h)},this.angSpeed=3,this.speed=40,this.mesh=r.buildMesh(),this.direction=u(),this.hitbox=new g(this.mesh,r.getHitboxGeometry()),this.epoch=0},_=function e(){var t=this;Object(o.a)(this,e),this.mesh=void 0,this.hitboxGeometry=void 0,this.buildMesh=function(){return t.mesh.clone()},this.getHitboxGeometry=function(){return t.hitboxGeometry.clone()},this.hitboxGeometry=new n.h(.2,.4,1,6,1);var i=new n.p({wireframe:!0,color:16777215}),s=new n.g(.3,1,6),r=new n.p({wireframe:!0,color:15658100}),a=new n.p({wireframe:!0,color:15618359}),h=new n.o(s,r),c=new n.o(s,a);h.position.y-=1,c.position.y-=1,h.rotateX(Math.PI),c.rotateX(Math.PI),this.mesh=new n.o(this.hitboxGeometry,i),this.mesh.add(h),this.mesh.add(c)},ee=function e(t,i,s,r,a){var h=this;Object(o.a)(this,e),this.scene=t,this.clock=s,this.collider=r,this.idleObjects=void 0,this.liveObjects=void 0,this.intervalId=void 0,this.start=function(){var e=new n.D(0,0,0);h.spawn(e,u()),h.intervalId=setInterval((function(){return h.spawn(e,u())}),1e4)},this.spawn=function(e,t){var i=m(j(h.idleObjects));h.idleObjects.delete(i),h.liveObjects.add(i),i.spawn(e,t),h.collider.addObjectToGroup(i,X.missiles)},this.drop=function(e){e.mesh.position.copy(v()),h.liveObjects.delete(e),h.idleObjects.add(e),h.collider.removeObjectFromGroup(e,X.missiles)},this.update=function(){h.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){h.liveObjects.forEach((function(e){return h.scene.remove(e.mesh)})),h.idleObjects.forEach((function(e){return h.scene.remove(e.mesh)})),null!==h.intervalId&&clearInterval(h.intervalId)},this.idleObjects=new Set,this.liveObjects=new Set;var d=new _;c(50,(function(e){var t=new $(i,h.clock,a,d,h.drop);t.mesh.position.copy(v()),h.idleObjects.add(t)})),this.idleObjects.forEach((function(e){return h.scene.add(e.mesh)})),this.intervalId=null},te=function e(t,i,s){var n=this;Object(o.a)(this,e),this.clock=i,this.dropObject=s,this.mesh=void 0,this.hitbox=void 0,this.speed=void 0,this.spawn=function(e){n.mesh.position.copy(e)},this.onCollide=function(e){n.drop()},this.update=function(){var e=n.clock.getDelta(),t=n.mesh.position.length(),i=n.speed*e;n.mesh.position.setLength(t-i),n.hitbox.update(),n.mesh.position.length()<=5&&n.drop()},this.drop=function(){n.dropObject(n)},this.mesh=t.buildMesh(),this.hitbox=new g(this.mesh,t.getHitboxGeometry()),this.speed=200},ie=function e(){var t=this;Object(o.a)(this,e),this.mesh=void 0,this.hitboxGeometry=void 0,this.buildMesh=function(){return t.mesh.clone()},this.getHitboxGeometry=function(){return t.hitboxGeometry.clone()};var i=new n.i(.15),s=new n.p({color:16773998,wireframe:!0}),r=new n.o(i,s);this.hitboxGeometry=new n.i(.3);var a=new n.p({color:14058496,wireframe:!0});this.mesh=new n.o(this.hitboxGeometry,a),this.mesh.add(r)},se=function e(t,i,s,n){var r=this;Object(o.a)(this,e),this.scene=t,this.collider=i,this.clock=s,this.sounds=n,this.idleObjects=void 0,this.liveObjects=void 0,this.spawn=function(e){var t=m(j(r.idleObjects));r.idleObjects.delete(t),r.liveObjects.add(t),t.spawn(e),r.collider.addObjectToGroup(t,X.shots),r.sounds.playShot()},this.drop=function(e){e.mesh.position.copy(v()),r.liveObjects.delete(e),r.idleObjects.add(e),r.collider.removeObjectFromGroup(e,X.shots)},this.update=function(){r.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){r.liveObjects.forEach((function(e){return r.scene.remove(e.mesh)})),r.idleObjects.forEach((function(e){return r.scene.remove(e.mesh)}))},this.idleObjects=new Set,this.liveObjects=new Set;var a=new ie;c(20,(function(e){var t=new te(a,r.clock,r.drop);t.mesh.position.copy(v()),r.idleObjects.add(t)})),this.idleObjects.forEach((function(e){return r.scene.add(e.mesh)}))},oe=i(18),ne=function(){function e(t,i,s){var n=this;Object(o.a)(this,e),this.clock=i,this.dropObject=s,this.hitbox=void 0,this.explosionMesh=void 0,this.epoch=void 0,this.fragmentSpeeds=void 0,this.spawn=function(e){n.mesh.position.copy(e),n.epoch=n.clock.getElapsed(),n.fragmentSpeeds=n.getRandomSpeeds(),n.explosionMesh.traverseFragments((function(e){e.setRadiusToCenter(.1)}))},this.onCollide=w,this.update=function(){var e=n.clock.getElapsed(),t=n.clock.getDelta(),i=e-n.epoch;n.explosionMesh.traverseFragments((function(e,i){var s=n.fragmentSpeeds[i];e.extendRadius(t*s)}));var s=x(k(i,0,1,0,1));n.explosionMesh.updateMaterial(s),i>1&&n.drop()},this.getRandomSpeeds=function(){var e=[];return n.explosionMesh.traverseFragments((function(t){var i=l(2.5,5);e.push(i)})),e},this.drop=function(){n.dropObject(n)},this.explosionMesh=t.buildMesh(),this.hitbox=new y,this.epoch=0,this.fragmentSpeeds=this.getRandomSpeeds()}return Object(oe.a)(e,[{key:"mesh",get:function(){return this.explosionMesh.mesh}}]),e}(),re=new n.f(16777110),ae=new n.f(6357504),he=function e(t){var i=this;Object(o.a)(this,e),this.mesh=void 0,this.setPosition=function(e,t,s){i.mesh.position.set(e,t,s)},this.setRadiusToCenter=function(e){i.mesh.position.setLength(e)},this.extendRadius=function(e){var t=i.mesh.position.clone().setLength(e);i.mesh.position.add(t)};var s=l(.25,1),r=new n.A(s);this.mesh=new n.o(r,t)},ce=function e(){var t=this;Object(o.a)(this,e),this.mesh=void 0,this.fragments=void 0,this.fragmentMaterial=void 0,this.traverseFragments=function(e){t.fragments.forEach((function(t,i){return e(t,i)}))},this.updateMaterial=function(e){var i=1-e,s=new n.f(re).lerp(ae,e);t.fragmentMaterial.opacity=i,t.fragmentMaterial.color=s},this.buildFragments=function(){for(var e=new n.z(.1,6,6).getAttribute("position"),i=[],s=0;s<e.count;s++){var o=e.getX(s),r=e.getY(s),a=e.getZ(s),h=new he(t.fragmentMaterial);h.setPosition(o,r,a),t.mesh.add(h.mesh),i.push(h)}return i},this.mesh=new n.o,this.fragmentMaterial=new n.p({color:re,wireframe:!0,transparent:!0}),this.fragments=this.buildFragments();var i=l(0,2*Math.PI);this.mesh.rotateOnAxis(u(),i)},de=function e(){Object(o.a)(this,e),this.buildMesh=function(){return new ce}},le=function e(t,i){var s=this;Object(o.a)(this,e),this.scene=t,this.clock=i,this.idleObjects=void 0,this.liveObjects=void 0,this.spawn=function(e){var t=m(j(s.idleObjects));s.idleObjects.delete(t),s.liveObjects.add(t),t.spawn(e)},this.drop=function(e){e.mesh.position.copy(v()),s.liveObjects.delete(e),s.idleObjects.add(e)},this.update=function(){s.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){s.liveObjects.forEach((function(e){return s.scene.remove(e.mesh)})),s.idleObjects.forEach((function(e){return s.scene.remove(e.mesh)}))},this.idleObjects=new Set,this.liveObjects=new Set;var n=new de;c(50,(function(e){var t=new ne(n,s.clock,s.drop);t.mesh.position.copy(v()),s.idleObjects.add(t)})),this.idleObjects.forEach((function(e){return s.scene.add(e.mesh)}))},ue=(i(42),function e(){Object(o.a)(this,e),this.playShot=w,this.playPickup=w,this.dispose=w}),pe=function e(){var t=this;Object(o.a)(this,e),this.renderer=void 0,this.clock=void 0,this.camera=void 0,this.keyboardControls=void 0,this.objectController=void 0,this.center=void 0,this.ship=void 0,this.scene=void 0,this.explosions=void 0,this.asteroids=void 0,this.missiles=void 0,this.shots=void 0,this.collider=void 0,this.sounds=void 0,this.start=function(){var e;t.keyboardControls.attachListeners(),window.addEventListener("resize",t.resize),t.asteroids.start(),t.missiles.start(),e="Game started!",console.log("%c".concat(e),"\n        background-color: #dadada;\n        color: #2b2bfa;\n        margin: 1em;\n        padding: 0.5em 1em;\n        border-radius: 9999px;\n        font-size: 14px;\n        text-align: center;\n        font-weight: 800;\n    "),t.animate()},this.dispose=function(){t.keyboardControls.dispose(),t.asteroids.dispose(),t.missiles.dispose(),t.explosions.dispose(),t.sounds.dispose(),t.scene.dispose(),window.removeEventListener("resize",t.resize)},this.getDomElement=function(){return t.renderer.getDomElement()},this.resize=function(){t.renderer.resize(),t.camera.aspect=window.innerWidth/window.innerHeight,t.camera.updateProjectionMatrix()},this.animate=function(){t.clock.tick(),t.objectController.update(),t.ship.update(),t.center.update(),t.missiles.update(),t.asteroids.update(),t.shots.update(),t.explosions.update(),t.collider.update(),t.camera.update(),t.renderer.render(),requestAnimationFrame(t.animate)},this.scene=new U,this.clock=new z,this.collider=new N,this.collider.addRule(X.asteroids,X.ship),this.collider.addRule(X.shots,X.asteroids),this.collider.addRule(X.shots,X.center),this.collider.addRule(X.shots,X.missiles),this.collider.addRule(X.missiles,X.ship),this.sounds=new ue,this.explosions=new le(this.scene,this.clock),this.ship=new R,this.collider.addObjectToGroup(this.ship,X.ship),this.camera=new F(this.ship.mesh),this.renderer=new V(this.scene.scene,this.camera),this.renderer.resize();var i=new O;this.center=new E(this.clock),this.collider.addObjectToGroup(this.center,X.center),this.scene.add(this.ship.mesh,i.mesh,this.center.mesh),this.asteroids=new Q(this.scene,this.collider,this.clock,this.explosions),this.missiles=new ee(this.scene,this.ship.mesh,this.clock,this.collider,this.explosions),this.shots=new se(this.scene,this.collider,this.clock,this.sounds),this.keyboardControls=new G,this.objectController=new A(this.keyboardControls,this.ship.mesh,this.shots,this.clock)};var ve=function(){var e=function(e){var t=Object(s.useRef)(null);return null===t.current&&(t.current=e()),t.current}((function(){return new pe}));Object(s.useEffect)((function(){return e.start(),function(){return e.dispose()}}),[e]);return function(t){m(t).appendChild(e.getDomElement())}};t.default=function(){var e=ve();return(s.createElement("div",{className:"game-container",ref:e}))}}}]);
//# sourceMappingURL=4.8c52b94e.chunk.js.map