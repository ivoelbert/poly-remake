(this["webpackJsonppoly-remake"]=this["webpackJsonppoly-remake"]||[]).push([[0],{18:function(e,t,i){e.exports=i(25)},23:function(e,t,i){},24:function(e,t,i){},25:function(e,t,i){"use strict";i.r(t);var n,s=i(4),o=i.n(s),r=i(13),a=i.n(r),c=(i(23),i(2)),h=i(0),d=i(5),l=i(6),u=i(15),p=(new h.B,function(e,t){for(var i=0;i<e;i++)t(i)}),v=h.n,m=function(){return new h.B(Math.random(),Math.random(),Math.random()).normalize()},w=function(){return new h.B(5e3,5e3,5e3)},f=function(e){return void 0===e||null===e},b=function(e,t){if(f(e))throw new j(t);return e},j=function(e){Object(d.a)(i,e);var t=Object(l.a)(i);function i(e){return Object(c.a)(this,i),t.call(this,null!==e&&void 0!==e?e:"Unexpected nil value!")}return i}(Object(u.a)(Error)),O=function(e){return e.length()>75},g=function(e){return e.values().next().value},y=function e(){var t=this;Object(c.a)(this,e),this.mesh=void 0,this.createStarsGeometry=function(){var e=new h.k;return p(1e3,(function(t){var i=new h.B(v.randFloat(-1,1),v.randFloat(-1,1),v.randFloat(-1,1)),n=v.randFloat(100,500);i.multiplyScalar(n),e.vertices.push(i)})),e},this.mesh=new h.l,[new h.u({color:5592405,size:2,sizeAttenuation:!1}),new h.u({color:5592405,size:1,sizeAttenuation:!1}),new h.u({color:3355443,size:2,sizeAttenuation:!1}),new h.u({color:3815994,size:1,sizeAttenuation:!1}),new h.u({color:1710618,size:2,sizeAttenuation:!1}),new h.u({color:1710618,size:1,sizeAttenuation:!1})].forEach((function(e){var i=t.createStarsGeometry(),n=new h.t(i,e);n.matrixAutoUpdate=!1,n.updateMatrix(),t.mesh.add(n)}))},k=function e(){Object(c.a)(this,e),this.mesh=void 0,this.mesh=new h.l;var t=new h.y(5,16,12),i=new h.p({color:16395051,wireframe:!0}),n=new h.o(t,i);this.mesh.add(n)},S=i(1);!function(e){e.up="up",e.down="down",e.left="left",e.right="right",e.forwards="forwards",e.backwards="backwards",e.rollLeft="rollLeft",e.rollRight="rollRight",e.shoot="shoot"}(n||(n={}));var E=function(){var e;return e={},Object(S.a)(e,n.up,0),Object(S.a)(e,n.down,0),Object(S.a)(e,n.left,0),Object(S.a)(e,n.right,0),Object(S.a)(e,n.forwards,0),Object(S.a)(e,n.backwards,0),Object(S.a)(e,n.rollLeft,0),Object(S.a)(e,n.rollRight,0),Object(S.a)(e,n.shoot,0),e},z=function e(){var t=this;Object(c.a)(this,e),this.moveState=void 0,this.keyMapping=void 0,this.bindKey=function(e,i){t.keyMapping.set(e,i),t.moveState=E()},this.attachListeners=function(){window.addEventListener("keydown",t.keyDownHandler),window.addEventListener("keyup",t.keyUpHandler)},this.dispose=function(){window.addEventListener("keydown",t.keyDownHandler),window.addEventListener("keyup",t.keyUpHandler)},this.keyDownHandler=function(e){var i=t.keyMapping.get(e.code);f(i)||(t.moveState[i]=1)},this.keyUpHandler=function(e){var i=t.keyMapping.get(e.code);f(i)||(t.moveState[i]=0)},this.moveState=E(),this.keyMapping=function(){var e=new Map;return e.set("KeyW",n.up),e.set("KeyS",n.down),e.set("KeyA",n.left),e.set("KeyD",n.right),e.set("KeyI",n.forwards),e.set("KeyK",n.backwards),e.set("KeyJ",n.rollLeft),e.set("KeyL",n.rollRight),e.set("Space",n.shoot),e}()},A=function e(){var t=this;Object(c.a)(this,e),this.clock=void 0,this.delta=void 0,this.elapsed=void 0,this.tick=function(){t.delta=t.clock.getDelta(),t.elapsed=t.clock.getElapsedTime()},this.clock=new h.e,this.delta=0,this.elapsed=0};A.instance=void 0,A.getInstance=function(){return A.instance||(A.instance=new A),A.instance};var M=function e(t,i,s){var o=this;Object(c.a)(this,e),this.controls=t,this.object=i,this.shots=s,this.clock=void 0,this.moveState=void 0,this.shotDelta=void 0,this.orbitSpeed=void 0,this.rollSpeed=void 0,this.forwardsAndBackwardsSpeed=void 0,this.inertiaFactor=void 0,this.shotRecoveryTime=void 0,this.update=function(){o.moveState=function(e,t,i){var s;return s={},Object(S.a)(s,n.up,v.lerp(e[n.up],t[n.up],i)),Object(S.a)(s,n.down,v.lerp(e[n.down],t[n.down],i)),Object(S.a)(s,n.left,v.lerp(e[n.left],t[n.left],i)),Object(S.a)(s,n.right,v.lerp(e[n.right],t[n.right],i)),Object(S.a)(s,n.forwards,v.lerp(e[n.forwards],t[n.forwards],i)),Object(S.a)(s,n.backwards,v.lerp(e[n.backwards],t[n.backwards],i)),Object(S.a)(s,n.rollLeft,v.lerp(e[n.rollLeft],t[n.rollLeft],i)),Object(S.a)(s,n.rollRight,v.lerp(e[n.rollRight],t[n.rollRight],i)),Object(S.a)(s,n.shoot,t[n.shoot]),s}(o.moveState,o.controls.moveState,o.inertiaFactor),o.updateDepth(),o.updateOrbit(),o.updateShots()},this.updateDepth=function(){var e=o.moveState[n.backwards]-o.moveState[n.forwards];if(Math.abs(e)>1e-5){var t=e*o.forwardsAndBackwardsSpeed,i=o.object.position.length();i+t<15?i=15:i+t>50?i=50:i+=t,o.object.position.setLength(i)}},this.updateOrbit=function(){var e=new h.B,t=new h.B,i=new h.B;o.object.matrix.extractBasis(e,t,i);var s=o.moveState[n.up]-o.moveState[n.down],r=o.moveState[n.right]-o.moveState[n.left],a=e.clone();a.multiplyScalar(s);var c=t.clone();c.multiplyScalar(r);var d=(new h.B).addVectors(a,c).clampLength(0,1),l=d.length();l>1e-5&&(d.normalize(),o.object.position.applyAxisAngle(d,l*o.orbitSpeed));var u=o.moveState[n.rollRight]-o.moveState[n.rollLeft];t.applyAxisAngle(i,u*o.rollSpeed),o.object.up.copy(t),o.object.lookAt(0,0,0)},this.updateShots=function(){var e=o.clock.delta;o.shotDelta+=e,o.shotDelta>o.shotRecoveryTime&&1===o.moveState[n.shoot]&&(o.shotDelta=0,o.shots.spawn(o.object.position))},this.clock=A.getInstance(),this.moveState=E(),this.shotDelta=0,this.orbitSpeed=.05,this.rollSpeed=.05,this.forwardsAndBackwardsSpeed=.5,this.inertiaFactor=.1,this.shotRecoveryTime=.15,this.update()},F=function e(){Object(c.a)(this,e),this.mesh=void 0,this.createGeometry=function(){var e=new h.d,t=[0,0,1],i=[0,.25,0],n=[-.5,-.25,0],s=[.5,-.25,0],o=new Float32Array([].concat(t,i,n,t,i,s,t,n,s,i,n,s));return e.setAttribute("position",new h.c(o,3)),e};var t=this.createGeometry(),i=new h.p({color:16448250,wireframe:!0});this.mesh=new h.o(t,i),this.mesh.position.set(0,0,50)},L=function(e){Object(d.a)(i,e);var t=Object(l.a)(i);function i(e){var n;return Object(c.a)(this,i),(n=t.call(this,75,window.innerWidth/window.innerHeight,.1,1e3)).followedObject=e,n.clock=void 0,n.distance=void 0,n.inertiaFactor=void 0,n.update=function(){var e=n.followedObject.position.clone();e.add(e.clone().normalize().multiplyScalar(n.distance));var t=(new h.B).lerpVectors(n.position,e,n.inertiaFactor);n.position.copy(t),n.up.copy(n.followedObject.up),n.lookAt(0,0,0)},n.distance=2,n.inertiaFactor=.8,n.clock=A.getInstance(),n.update(),n}return i}(h.r),B=i(14),I=i(17),x=i(16),D=1.05,R=1.2,H=0,K=0,V=function e(t,i){var n=this;Object(c.a)(this,e),this.renderer=void 0,this.composer=void 0,this.getDomElement=function(){return n.renderer.domElement},this.resize=function(){n.renderer.setSize(window.innerWidth,window.innerHeight),n.composer.setSize(window.innerWidth,window.innerHeight)},this.render=function(){n.composer.render()},this.renderer=new h.D,this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.toneMappingExposure=Math.pow(D,4);var s=new B.a(t,i),o=new I.a(new h.A(window.innerWidth,window.innerHeight),1.5,.4,.85);o.threshold=H,o.strength=R,o.radius=K,this.composer=new x.a(this.renderer),this.composer.renderToScreen=!1,this.composer.addPass(s),this.composer.addPass(o),this.composer.renderToScreen=!0},P=function e(){var t=this;Object(c.a)(this,e),this.scene=void 0,this.add=function(){var e;return(e=t.scene).add.apply(e,arguments)},this.remove=function(){var e;return(e=t.scene).remove.apply(e,arguments)},this.dispose=function(){return t.scene.dispose()},this.scene=new h.w,this.scene.fog=new h.j(0,25e-6);var i=new h.b(16777215);this.scene.add(i)};P.instance=void 0,P.getInstance=function(){return P.instance||(P.instance=new P),P.instance};var T=function e(t,i){var n=this;Object(c.a)(this,e),this.mesh=void 0,this.normal=void 0,this.drop=void 0,this.angularVelocity=void 0,this.radialVelocity=void 0,this.clock=void 0,this.spawn=function(e,t){n.mesh.position.copy(e),n.normal=t},this.update=function(){var e=n.clock.delta,t=n.angularVelocity*e;n.mesh.position.applyAxisAngle(n.normal,t);var i=n.mesh.position.length(),s=n.radialVelocity*e;n.mesh.position.setLength(i+s),O(n.mesh.position)&&(console.log("dropping asteroid!"),n.drop())},this.mesh=t.buildMesh(),this.normal=new h.B(0,1,0),this.angularVelocity=1,this.radialVelocity=1,this.clock=A.getInstance(),this.drop=function(){return i(n)}},W=function e(){var t=this;Object(c.a)(this,e),this.mesh=void 0,this.buildMesh=function(){return t.mesh.clone()};var i=new h.i(1),n=new h.p({color:2882091,wireframe:!0});this.mesh=new h.o(i,n)},G=function e(){var t=this;Object(c.a)(this,e),this.idleObjects=void 0,this.liveObjects=void 0,this.scene=void 0,this.meshFactory=void 0,this.spawn=function(e,i){var n=b(g(t.idleObjects));t.idleObjects.delete(n),t.liveObjects.add(n),n.spawn(e,i)},this.drop=function(e){e.mesh.position.copy(w()),t.liveObjects.delete(e),t.idleObjects.add(e)},this.update=function(){t.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){t.liveObjects.forEach((function(e){return t.scene.remove(e.mesh)})),t.idleObjects.forEach((function(e){return t.scene.remove(e.mesh)}))},this.idleObjects=new Set,this.liveObjects=new Set,this.scene=P.getInstance(),this.meshFactory=new W,p(50,(function(e){var i=new T(t.meshFactory,t.drop);i.mesh.position.copy(w()),t.idleObjects.add(i)})),this.idleObjects.forEach((function(e){return t.scene.add(e.mesh)}));var i=new h.B(0,15,0);this.spawn(i,m()),setInterval((function(){return t.spawn(i,m())}),1e4)},U=function e(t,i,n){var s=this;Object(c.a)(this,e),this.object=t,this.mesh=void 0,this.direction=void 0,this.clock=void 0,this.drop=void 0,this.angSpeed=void 0,this.speed=void 0,this.spawn=function(e,t){s.mesh.position.copy(e),s.direction.copy(t),s.direction.normalize(),s.align()},this.update=function(){s.updateRotation(),s.updatePosition(),s.updateFlames(),O(s.mesh.position)&&s.drop()},this.updateRotation=function(){var e=s.clock.delta,t=s.object.position.clone();t.sub(s.mesh.position);var i=s.direction.angleTo(t),n=v.clamp(i,-s.angSpeed*e,s.angSpeed*e),o=(new h.B).crossVectors(t,s.direction);o.normalize(),s.direction.applyAxisAngle(o,-n),s.align()},this.updatePosition=function(){var e=s.clock.delta,t=s.direction.clone();t.multiplyScalar(s.speed*e),s.mesh.position.add(t)},this.updateFlames=function(){var e=s.clock.delta,t=s.clock.elapsed;s.mesh.children[0].scale.y+=.05*Math.sin(10*t),s.mesh.children[0].rotateY(10*e),s.mesh.children[1].scale.y-=.05*Math.cos(10*t),s.mesh.children[1].rotateY(10*e)},this.align=function(){var e=s.mesh.position.clone();e.add(s.direction),s.mesh.lookAt(e),s.mesh.rotateOnAxis(new h.B(1,0,0),.5*Math.PI)},this.clock=A.getInstance(),this.angSpeed=3,this.speed=40,this.mesh=i.buildMesh(),this.direction=m(),this.drop=function(){return n(s)}},C=function e(){var t=this;Object(c.a)(this,e),this.mesh=void 0,this.buildMesh=function(){return t.mesh.clone()};var i=new h.h(.2,.4,1,6,1),n=new h.p({wireframe:!0,color:16777215}),s=new h.g(.3,1,6),o=new h.p({wireframe:!0,color:15658100}),r=new h.p({wireframe:!0,color:15618359}),a=new h.o(s,o),d=new h.o(s,r);a.position.y-=1,d.position.y-=1,a.rotateX(Math.PI),d.rotateX(Math.PI),this.mesh=new h.o(i,n),this.mesh.add(a),this.mesh.add(d)},J=function e(t){var i=this;Object(c.a)(this,e),this.idleObjects=void 0,this.liveObjects=void 0,this.scene=void 0,this.meshFactory=void 0,this.spawn=function(e,t){var n=b(g(i.idleObjects));i.idleObjects.delete(n),i.liveObjects.add(n),n.spawn(e,t)},this.drop=function(e){e.mesh.position.copy(w()),i.liveObjects.delete(e),i.idleObjects.add(e)},this.update=function(){i.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){i.liveObjects.forEach((function(e){return i.scene.remove(e.mesh)})),i.idleObjects.forEach((function(e){return i.scene.remove(e.mesh)}))},this.idleObjects=new Set,this.liveObjects=new Set,this.scene=P.getInstance(),this.meshFactory=new C,p(50,(function(e){var n=new U(t,i.meshFactory,i.drop);n.mesh.position.copy(w()),i.idleObjects.add(n)})),this.idleObjects.forEach((function(e){return i.scene.add(e.mesh)}));var n=new h.B(0,0,0);this.spawn(n,m()),setInterval((function(){return i.spawn(n,m())}),1e4)},X=function e(t,i){var n=this;Object(c.a)(this,e),this.mesh=void 0,this.drop=void 0,this.speed=void 0,this.clock=void 0,this.spawn=function(e){n.mesh.position.copy(e)},this.update=function(){var e=n.clock.delta,t=n.mesh.position.length(),i=n.speed*e;n.mesh.position.setLength(t-i),n.mesh.position.length()<=5&&n.drop()},this.mesh=t.buildMesh(),this.speed=200,this.clock=A.getInstance(),this.drop=function(){return i(n)}},Y=function e(){var t=this;Object(c.a)(this,e),this.mesh=void 0,this.buildMesh=function(){return t.mesh.clone()};var i=new h.i(.15),n=new h.p({color:16773998,wireframe:!0}),s=new h.o(i,n),o=new h.i(.3),r=new h.p({color:14058496,wireframe:!0});this.mesh=new h.o(o,r),this.mesh.add(s)},q=function e(){var t=this;Object(c.a)(this,e),this.idleObjects=void 0,this.liveObjects=void 0,this.scene=void 0,this.meshFactory=void 0,this.spawn=function(e){var i=b(g(t.idleObjects));t.idleObjects.delete(i),t.liveObjects.add(i),i.spawn(e)},this.drop=function(e){e.mesh.position.copy(w()),t.liveObjects.delete(e),t.idleObjects.add(e)},this.update=function(){t.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){t.liveObjects.forEach((function(e){return t.scene.remove(e.mesh)})),t.idleObjects.forEach((function(e){return t.scene.remove(e.mesh)}))},this.idleObjects=new Set,this.liveObjects=new Set,this.scene=P.getInstance(),this.meshFactory=new Y,p(20,(function(e){var i=new X(t.meshFactory,t.drop);i.mesh.position.copy(w()),t.idleObjects.add(i)})),this.idleObjects.forEach((function(e){return t.scene.add(e.mesh)}))},N=new function e(){var t=this;Object(c.a)(this,e),this.renderer=void 0,this.clock=void 0,this.camera=void 0,this.controls=void 0,this.objectController=void 0,this.ship=void 0,this.scene=void 0,this.asteroids=void 0,this.missiles=void 0,this.shots=void 0,this.attachListeners=function(){t.controls.attachListeners(),window.addEventListener("resize",t.resize)},this.dispose=function(){t.controls.dispose(),t.asteroids.dispose(),t.missiles.dispose(),window.removeEventListener("resize",t.resize)},this.getDomElement=function(){return t.renderer.getDomElement()},this.resize=function(){t.renderer.resize(),t.camera.aspect=window.innerWidth/window.innerHeight,t.camera.updateProjectionMatrix()},this.animate=function(){requestAnimationFrame(t.animate),t.clock.tick(),t.objectController.update(),t.camera.update(),t.missiles.update(),t.asteroids.update(),t.shots.update(),t.renderer.render()},this.scene=P.getInstance(),this.clock=A.getInstance(),this.ship=new F,this.camera=new L(this.ship.mesh),this.renderer=new V(this.scene.scene,this.camera),this.renderer.resize();var i,n=new y,s=new k;this.scene.add(this.ship.mesh,n.mesh,s.mesh),this.asteroids=new G,this.missiles=new J(this.ship.mesh),this.shots=new q,this.controls=new z,this.objectController=new M(this.controls,this.ship.mesh,this.shots),i="Game started!",console.log("%c".concat(i),"\n        background-color: #dadada;\n        color: #2b2bfa;\n        margin: 1em;\n        padding: 0.5em 1em;\n        border-radius: 9999px;\n        font-size: 14px;\n        text-align: center;\n        font-weight: 800;\n    "),this.animate()};var Q=function(){var e=function(){Object(s.useEffect)((function(){return N.attachListeners(),function(){return N.dispose()}}),[]);return function(e){b(e).appendChild(N.getDomElement())}}();return(o.a.createElement("div",{className:"App",ref:e}))};i(24);a.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(Q,null)),document.getElementById("root"))}},[[18,1,2]]]);
//# sourceMappingURL=main.1e9cd055.chunk.js.map