(this["webpackJsonppoly-remake"]=this["webpackJsonppoly-remake"]||[]).push([[0],{19:function(e,t,i){e.exports=i(26)},24:function(e,t,i){},25:function(e,t,i){},26:function(e,t,i){"use strict";i.r(t);var o=i(4),s=i.n(o),n=i(13),r=i.n(n),a=(i(24),i(2)),c=i(0),h=i(5),d=i(6),l=i(16),u=(new c.B,function(e,t){for(var i=0;i<e;i++)t(i)}),p=c.n,m=function(){return new c.B(Math.random(),Math.random(),Math.random()).normalize()},v=function(){return new c.B(5e3,5e3,5e3)},w=function(e){return void 0===e||null===e},f=function(e,t){if(w(e))throw new b(t);return e},b=function(e){Object(h.a)(i,e);var t=Object(d.a)(i);function i(e){return Object(a.a)(this,i),t.call(this,null!==e&&void 0!==e?e:"Unexpected nil value!")}return i}(Object(l.a)(Error)),j=function(e){return e.length()>75},O=function(e){return e.values().next().value},g=function e(){var t=this;Object(a.a)(this,e),this.mesh=void 0,this.createStarsGeometry=function(){var e=new c.k;return u(1e3,(function(t){var i=new c.B(p.randFloat(-1,1),p.randFloat(-1,1),p.randFloat(-1,1)),o=p.randFloat(100,500);i.multiplyScalar(o),e.vertices.push(i)})),e},this.mesh=new c.l,[new c.u({color:5592405,size:2,sizeAttenuation:!1}),new c.u({color:5592405,size:1,sizeAttenuation:!1}),new c.u({color:3355443,size:2,sizeAttenuation:!1}),new c.u({color:3815994,size:1,sizeAttenuation:!1}),new c.u({color:1710618,size:2,sizeAttenuation:!1}),new c.u({color:1710618,size:1,sizeAttenuation:!1})].forEach((function(e){var i=t.createStarsGeometry(),o=new c.t(i,e);o.matrixAutoUpdate=!1,o.updateMatrix(),t.mesh.add(o)}))},y=function e(){var t=this;Object(a.a)(this,e),this.scene=void 0,this.add=function(){var e;return(e=t.scene).add.apply(e,arguments)},this.remove=function(){var e;return(e=t.scene).remove.apply(e,arguments)},this.dispose=function(){return t.scene.dispose()},this.scene=new c.w,this.scene.fog=new c.j(0,25e-6);var i=new c.b(16777215);this.scene.add(i)};y.instance=void 0,y.getInstance=function(){return y.instance||(y.instance=new y),y.instance};var S,k=function e(t,i){var o=this;Object(a.a)(this,e),this.followedObject=t,this.shape=void 0,this.hitboxDebug=void 0,this.debug=function(){var e=y.getInstance(),t=new c.y(o.shape.radius,8,6),i=new c.p({color:3296424,wireframe:!0});o.hitboxDebug=new c.o(t,i),e.add(o.hitboxDebug),o.update()},this.update=function(){var e=o.followedObject.position.clone();o.shape.center.copy(e),w(o.hitboxDebug)||o.hitboxDebug.position.copy(e)},this.intersects=function(e){return o.shape.intersectsSphere(e.shape)};var s=i.clone();s.computeBoundingSphere(),this.shape=f(s.boundingSphere),this.hitboxDebug=null,this.update()},x=function e(){Object(a.a)(this,e),this.mesh=void 0,this.hitbox=void 0,this.mesh=new c.l;var t=new c.y(5,16,12),i=new c.p({color:16395051,wireframe:!0}),o=new c.o(t,i);this.mesh.add(o),this.hitbox=new k(this.mesh,t)},E=i(1);!function(e){e.up="up",e.down="down",e.left="left",e.right="right",e.forwards="forwards",e.backwards="backwards",e.rollLeft="rollLeft",e.rollRight="rollRight",e.shoot="shoot"}(S||(S={}));var G=function(){var e;return e={},Object(E.a)(e,S.up,0),Object(E.a)(e,S.down,0),Object(E.a)(e,S.left,0),Object(E.a)(e,S.right,0),Object(E.a)(e,S.forwards,0),Object(E.a)(e,S.backwards,0),Object(E.a)(e,S.rollLeft,0),Object(E.a)(e,S.rollRight,0),Object(E.a)(e,S.shoot,0),e},z=function e(){var t=this;Object(a.a)(this,e),this.moveState=void 0,this.keyMapping=void 0,this.bindKey=function(e,i){t.keyMapping.set(e,i),t.moveState=G()},this.attachListeners=function(){window.addEventListener("keydown",t.keyDownHandler),window.addEventListener("keyup",t.keyUpHandler)},this.dispose=function(){window.addEventListener("keydown",t.keyDownHandler),window.addEventListener("keyup",t.keyUpHandler)},this.keyDownHandler=function(e){var i=t.keyMapping.get(e.code);w(i)||(t.moveState[i]=1)},this.keyUpHandler=function(e){var i=t.keyMapping.get(e.code);w(i)||(t.moveState[i]=0)},this.moveState=G(),this.keyMapping=function(){var e=new Map;return e.set("KeyW",S.up),e.set("KeyS",S.down),e.set("KeyA",S.left),e.set("KeyD",S.right),e.set("KeyI",S.forwards),e.set("KeyK",S.backwards),e.set("KeyJ",S.rollLeft),e.set("KeyL",S.rollRight),e.set("Space",S.shoot),e}()},A=function e(){var t=this;Object(a.a)(this,e),this.clock=void 0,this.delta=void 0,this.elapsed=void 0,this.tick=function(){t.delta=t.clock.getDelta(),t.elapsed=t.clock.getElapsedTime()},this.clock=new c.e,this.delta=0,this.elapsed=0};A.instance=void 0,A.getInstance=function(){return A.instance||(A.instance=new A),A.instance};var F,M=function e(t,i,o){var s=this;Object(a.a)(this,e),this.controls=t,this.object=i,this.shots=o,this.clock=void 0,this.moveState=void 0,this.shotDelta=void 0,this.orbitSpeed=void 0,this.rollSpeed=void 0,this.forwardsAndBackwardsSpeed=void 0,this.inertiaFactor=void 0,this.shotRecoveryTime=void 0,this.update=function(){s.moveState=function(e,t,i){var o;return o={},Object(E.a)(o,S.up,p.lerp(e[S.up],t[S.up],i)),Object(E.a)(o,S.down,p.lerp(e[S.down],t[S.down],i)),Object(E.a)(o,S.left,p.lerp(e[S.left],t[S.left],i)),Object(E.a)(o,S.right,p.lerp(e[S.right],t[S.right],i)),Object(E.a)(o,S.forwards,p.lerp(e[S.forwards],t[S.forwards],i)),Object(E.a)(o,S.backwards,p.lerp(e[S.backwards],t[S.backwards],i)),Object(E.a)(o,S.rollLeft,p.lerp(e[S.rollLeft],t[S.rollLeft],i)),Object(E.a)(o,S.rollRight,p.lerp(e[S.rollRight],t[S.rollRight],i)),Object(E.a)(o,S.shoot,t[S.shoot]),o}(s.moveState,s.controls.moveState,s.inertiaFactor),s.updateDepth(),s.updateOrbit(),s.updateShots()},this.updateDepth=function(){var e=s.moveState[S.backwards]-s.moveState[S.forwards];if(Math.abs(e)>1e-5){var t=e*s.forwardsAndBackwardsSpeed,i=s.object.position.length();i+t<15?i=15:i+t>50?i=50:i+=t,s.object.position.setLength(i)}},this.updateOrbit=function(){var e=new c.B,t=new c.B,i=new c.B;s.object.matrix.extractBasis(e,t,i);var o=s.moveState[S.up]-s.moveState[S.down],n=s.moveState[S.right]-s.moveState[S.left],r=e.clone();r.multiplyScalar(o);var a=t.clone();a.multiplyScalar(n);var h=(new c.B).addVectors(r,a).clampLength(0,1),d=h.length();d>1e-5&&(h.normalize(),s.object.position.applyAxisAngle(h,d*s.orbitSpeed));var l=s.moveState[S.rollRight]-s.moveState[S.rollLeft];t.applyAxisAngle(i,l*s.rollSpeed),s.object.up.copy(t),s.object.lookAt(0,0,0)},this.updateShots=function(){var e=s.clock.delta;s.shotDelta+=e,s.shotDelta>s.shotRecoveryTime&&1===s.moveState[S.shoot]&&(s.shotDelta=0,s.shots.spawn(s.object.position))},this.clock=A.getInstance(),this.moveState=G(),this.shotDelta=0,this.orbitSpeed=.05,this.rollSpeed=.05,this.forwardsAndBackwardsSpeed=.5,this.inertiaFactor=.1,this.shotRecoveryTime=.15,this.update()},D=function e(){var t=this;Object(a.a)(this,e),this.mesh=void 0,this.hitbox=void 0,this.update=function(){t.hitbox.update()},this.onCollide=function(e){console.log("OH SHIT!")},this.createGeometry=function(){var e=new c.d,t=[0,0,1],i=[0,.25,0],o=[-.5,-.25,0],s=[.5,-.25,0],n=new Float32Array([].concat(t,i,o,t,i,s,t,o,s,i,o,s));return e.setAttribute("position",new c.c(n,3)),e};var i=this.createGeometry(),o=new c.p({color:16448250,wireframe:!0});this.mesh=new c.o(i,o),this.mesh.position.set(0,0,50),this.hitbox=new k(this.mesh,i)},L=function(e){Object(h.a)(i,e);var t=Object(d.a)(i);function i(e){var o;return Object(a.a)(this,i),(o=t.call(this,75,window.innerWidth/window.innerHeight,.1,1e3)).followedObject=e,o.clock=void 0,o.distance=void 0,o.inertiaFactor=void 0,o.update=function(){var e=o.followedObject.position.clone();e.add(e.clone().normalize().multiplyScalar(o.distance));var t=(new c.B).lerpVectors(o.position,e,o.inertiaFactor);o.position.copy(t),o.up.copy(o.followedObject.up),o.lookAt(0,0,0)},o.distance=2,o.inertiaFactor=.8,o.clock=A.getInstance(),o.update(),o}return i}(c.r),I=i(14),B=i(18),H=i(17),R=1.05,T=1.2,C=0,K=0,V=function e(t,i){var o=this;Object(a.a)(this,e),this.renderer=void 0,this.composer=void 0,this.getDomElement=function(){return o.renderer.domElement},this.resize=function(){o.renderer.setSize(window.innerWidth,window.innerHeight),o.composer.setSize(window.innerWidth,window.innerHeight)},this.render=function(){o.composer.render()},this.renderer=new c.D,this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.toneMappingExposure=Math.pow(R,4);var s=new I.a(t,i),n=new B.a(new c.A(window.innerWidth,window.innerHeight),1.5,.4,.85);n.threshold=C,n.strength=T,n.radius=K,this.composer=new H.a(this.renderer),this.composer.renderToScreen=!1,this.composer.addPass(s),this.composer.addPass(n),this.composer.renderToScreen=!0},P=function e(t,i){var o=this;Object(a.a)(this,e),this.mesh=void 0,this.hitbox=void 0,this.normal=void 0,this.drop=void 0,this.angularVelocity=void 0,this.radialVelocity=void 0,this.clock=void 0,this.spawn=function(e,t){o.mesh.position.copy(e),o.normal=t},this.onCollide=function(e){o.drop()},this.update=function(){var e=o.clock.delta,t=o.angularVelocity*e;o.mesh.position.applyAxisAngle(o.normal,t);var i=o.mesh.position.length(),s=o.radialVelocity*e;o.mesh.position.setLength(i+s),o.hitbox.update(),j(o.mesh.position)&&(console.log("dropping asteroid!"),o.drop())},this.mesh=t.buildMesh(),this.hitbox=new k(this.mesh,t.getHitboxGeometry()),this.normal=new c.B(0,1,0),this.angularVelocity=1,this.radialVelocity=1,this.clock=A.getInstance(),this.drop=function(){return i(o)}},W=function e(){var t=this;Object(a.a)(this,e),this.mesh=void 0,this.hitboxGeometry=void 0,this.buildMesh=function(){return t.mesh.clone()},this.getHitboxGeometry=function(){return t.hitboxGeometry.clone()},this.hitboxGeometry=new c.i(1);var i=new c.p({color:2882091,wireframe:!0});this.mesh=new c.o(this.hitboxGeometry,i)},U=i(15);!function(e){e[e.asteroids=0]="asteroids",e[e.ship=1]="ship",e[e.shots=2]="shots",e[e.missiles=3]="missiles",e[e.center=4]="center"}(F||(F={}));var J=function e(){var t,i=this;Object(a.a)(this,e),this.rules=void 0,this.groups=void 0,this.addRule=function(e,t){i.rules.add([e,t])},this.addObjectToGroup=function(e,t){i.groups[t].add(e)},this.removeObjectFromGroup=function(e,t){i.groups[t].delete(e)},this.update=function(){i.rules.forEach((function(e){var t=Object(U.a)(e,2),o=t[0],s=t[1];i.groups[o].forEach((function(e){i.groups[s].forEach((function(t){var i,o;X(e,t)&&(null===(i=e.onCollide)||void 0===i||i.call(e,t),null===(o=t.onCollide)||void 0===o||o.call(t,e))}))}))}))},this.rules=new Set,this.groups=(t={},Object(E.a)(t,F.asteroids,new Set),Object(E.a)(t,F.ship,new Set),Object(E.a)(t,F.shots,new Set),Object(E.a)(t,F.missiles,new Set),Object(E.a)(t,F.center,new Set),t)},X=function(e,t){return e.hitbox.intersects(t.hitbox)},Y=function e(t){var i=this;Object(a.a)(this,e),this.collider=t,this.idleObjects=void 0,this.liveObjects=void 0,this.scene=void 0,this.meshFactory=void 0,this.spawn=function(e,t){var o=f(O(i.idleObjects));i.idleObjects.delete(o),i.liveObjects.add(o),o.spawn(e,t),i.collider.addObjectToGroup(o,F.asteroids)},this.drop=function(e){e.mesh.position.copy(v()),i.liveObjects.delete(e),i.idleObjects.add(e),i.collider.removeObjectFromGroup(e,F.asteroids)},this.update=function(){i.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){i.liveObjects.forEach((function(e){return i.scene.remove(e.mesh)})),i.idleObjects.forEach((function(e){return i.scene.remove(e.mesh)}))},this.idleObjects=new Set,this.liveObjects=new Set,this.scene=y.getInstance(),this.meshFactory=new W,u(50,(function(e){var t=new P(i.meshFactory,i.drop);t.mesh.position.copy(v()),i.idleObjects.add(t)})),this.idleObjects.forEach((function(e){return i.scene.add(e.mesh)}));var o=new c.B(0,15,0);this.spawn(o,m()),setInterval((function(){return i.spawn(o,m())}),1e4)},q=function e(t,i,o){var s=this;Object(a.a)(this,e),this.object=t,this.mesh=void 0,this.hitbox=void 0,this.direction=void 0,this.clock=void 0,this.drop=void 0,this.angSpeed=void 0,this.speed=void 0,this.spawn=function(e,t){s.mesh.position.copy(e),s.direction.copy(t),s.direction.normalize(),s.align()},this.update=function(){s.updateRotation(),s.updatePosition(),s.updateFlames(),s.hitbox.update(),j(s.mesh.position)&&s.drop()},this.onCollide=function(e){s.drop()},this.updateRotation=function(){var e=s.clock.delta,t=s.object.position.clone();t.sub(s.mesh.position);var i=s.direction.angleTo(t),o=p.clamp(i,-s.angSpeed*e,s.angSpeed*e),n=(new c.B).crossVectors(t,s.direction);n.normalize(),s.direction.applyAxisAngle(n,-o),s.align()},this.updatePosition=function(){var e=s.clock.delta,t=s.direction.clone();t.multiplyScalar(s.speed*e),s.mesh.position.add(t)},this.updateFlames=function(){var e=s.clock.delta,t=s.clock.elapsed;s.mesh.children[0].scale.y+=.05*Math.sin(10*t),s.mesh.children[0].rotateY(10*e),s.mesh.children[1].scale.y-=.05*Math.cos(10*t),s.mesh.children[1].rotateY(10*e)},this.align=function(){var e=s.mesh.position.clone();e.add(s.direction),s.mesh.lookAt(e),s.mesh.rotateOnAxis(new c.B(1,0,0),.5*Math.PI)},this.clock=A.getInstance(),this.angSpeed=3,this.speed=40,this.mesh=i.buildMesh(),this.direction=m(),this.hitbox=new k(this.mesh,i.getHitboxGeometry()),this.drop=function(){return o(s)}},N=function e(){var t=this;Object(a.a)(this,e),this.mesh=void 0,this.hitboxGeometry=void 0,this.buildMesh=function(){return t.mesh.clone()},this.getHitboxGeometry=function(){return t.hitboxGeometry.clone()},this.hitboxGeometry=new c.h(.2,.4,1,6,1);var i=new c.p({wireframe:!0,color:16777215}),o=new c.g(.3,1,6),s=new c.p({wireframe:!0,color:15658100}),n=new c.p({wireframe:!0,color:15618359}),r=new c.o(o,s),h=new c.o(o,n);r.position.y-=1,h.position.y-=1,r.rotateX(Math.PI),h.rotateX(Math.PI),this.mesh=new c.o(this.hitboxGeometry,i),this.mesh.add(r),this.mesh.add(h)},Q=function e(t,i){var o=this;Object(a.a)(this,e),this.collider=i,this.idleObjects=void 0,this.liveObjects=void 0,this.scene=void 0,this.meshFactory=void 0,this.spawn=function(e,t){var i=f(O(o.idleObjects));o.idleObjects.delete(i),o.liveObjects.add(i),i.spawn(e,t),o.collider.addObjectToGroup(i,F.missiles)},this.drop=function(e){e.mesh.position.copy(v()),o.liveObjects.delete(e),o.idleObjects.add(e),o.collider.removeObjectFromGroup(e,F.missiles)},this.update=function(){o.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){o.liveObjects.forEach((function(e){return o.scene.remove(e.mesh)})),o.idleObjects.forEach((function(e){return o.scene.remove(e.mesh)}))},this.idleObjects=new Set,this.liveObjects=new Set,this.scene=y.getInstance(),this.meshFactory=new N,u(50,(function(e){var i=new q(t,o.meshFactory,o.drop);i.mesh.position.copy(v()),o.idleObjects.add(i)})),this.idleObjects.forEach((function(e){return o.scene.add(e.mesh)}));var s=new c.B(0,0,0);this.spawn(s,m()),setInterval((function(){return o.spawn(s,m())}),1e4)},Z=function e(t,i){var o=this;Object(a.a)(this,e),this.mesh=void 0,this.hitbox=void 0,this.drop=void 0,this.speed=void 0,this.clock=void 0,this.spawn=function(e){o.mesh.position.copy(e)},this.onCollide=function(e){o.drop()},this.update=function(){var e=o.clock.delta,t=o.mesh.position.length(),i=o.speed*e;o.mesh.position.setLength(t-i),o.hitbox.update(),o.mesh.position.length()<=5&&o.drop()},this.mesh=t.buildMesh(),this.hitbox=new k(this.mesh,t.getHitboxGeometry()),this.speed=200,this.clock=A.getInstance(),this.drop=function(){return i(o)}},$=function e(){var t=this;Object(a.a)(this,e),this.mesh=void 0,this.hitboxGeometry=void 0,this.buildMesh=function(){return t.mesh.clone()},this.getHitboxGeometry=function(){return t.hitboxGeometry.clone()};var i=new c.i(.15),o=new c.p({color:16773998,wireframe:!0}),s=new c.o(i,o);this.hitboxGeometry=new c.i(.3);var n=new c.p({color:14058496,wireframe:!0});this.mesh=new c.o(this.hitboxGeometry,n),this.mesh.add(s)},_=function e(t){var i=this;Object(a.a)(this,e),this.collider=t,this.idleObjects=void 0,this.liveObjects=void 0,this.scene=void 0,this.meshFactory=void 0,this.spawn=function(e){var t=f(O(i.idleObjects));i.idleObjects.delete(t),i.liveObjects.add(t),t.spawn(e),i.collider.addObjectToGroup(t,F.shots)},this.drop=function(e){e.mesh.position.copy(v()),i.liveObjects.delete(e),i.idleObjects.add(e),i.collider.removeObjectFromGroup(e,F.shots)},this.update=function(){i.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){i.liveObjects.forEach((function(e){return i.scene.remove(e.mesh)})),i.idleObjects.forEach((function(e){return i.scene.remove(e.mesh)}))},this.idleObjects=new Set,this.liveObjects=new Set,this.scene=y.getInstance(),this.meshFactory=new $,u(20,(function(e){var t=new Z(i.meshFactory,i.drop);t.mesh.position.copy(v()),i.idleObjects.add(t)})),this.idleObjects.forEach((function(e){return i.scene.add(e.mesh)}))},ee=new function e(){var t=this;Object(a.a)(this,e),this.renderer=void 0,this.clock=void 0,this.camera=void 0,this.controls=void 0,this.objectController=void 0,this.ship=void 0,this.scene=void 0,this.asteroids=void 0,this.missiles=void 0,this.shots=void 0,this.collider=void 0,this.attachListeners=function(){t.controls.attachListeners(),window.addEventListener("resize",t.resize)},this.dispose=function(){t.controls.dispose(),t.asteroids.dispose(),t.missiles.dispose(),t.scene.dispose(),window.removeEventListener("resize",t.resize)},this.getDomElement=function(){return t.renderer.getDomElement()},this.resize=function(){t.renderer.resize(),t.camera.aspect=window.innerWidth/window.innerHeight,t.camera.updateProjectionMatrix()},this.animate=function(){requestAnimationFrame(t.animate),t.clock.tick(),t.objectController.update(),t.ship.update(),t.missiles.update(),t.asteroids.update(),t.shots.update(),t.collider.update(),t.camera.update(),t.renderer.render()},this.scene=y.getInstance(),this.clock=A.getInstance(),this.collider=new J,this.collider.addRule(F.asteroids,F.ship),this.collider.addRule(F.shots,F.asteroids),this.collider.addRule(F.shots,F.center),this.collider.addRule(F.shots,F.missiles),this.collider.addRule(F.missiles,F.ship),this.ship=new D,this.collider.addObjectToGroup(this.ship,F.ship),this.camera=new L(this.ship.mesh),this.renderer=new V(this.scene.scene,this.camera),this.renderer.resize();var i,o=new g,s=new x;this.collider.addObjectToGroup(s,F.center),this.scene.add(this.ship.mesh,o.mesh,s.mesh),this.asteroids=new Y(this.collider),this.missiles=new Q(this.ship.mesh,this.collider),this.shots=new _(this.collider),this.controls=new z,this.objectController=new M(this.controls,this.ship.mesh,this.shots),i="Game started!",console.log("%c".concat(i),"\n        background-color: #dadada;\n        color: #2b2bfa;\n        margin: 1em;\n        padding: 0.5em 1em;\n        border-radius: 9999px;\n        font-size: 14px;\n        text-align: center;\n        font-weight: 800;\n    "),this.animate()};var te=function(){var e=function(){Object(o.useEffect)((function(){return ee.attachListeners(),function(){return ee.dispose()}}),[]);return function(e){f(e).appendChild(ee.getDomElement())}}();return(s.a.createElement("div",{className:"App",ref:e}))};i(25);r.a.render(s.a.createElement(s.a.StrictMode,null,s.a.createElement(te,null)),document.getElementById("root"))}},[[19,1,2]]]);
//# sourceMappingURL=main.242ab0d9.chunk.js.map