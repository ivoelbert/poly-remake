(this["webpackJsonppoly-remake"]=this["webpackJsonppoly-remake"]||[]).push([[4],{47:function(e,t,i){"use strict";i.r(t);var s=i(0),o=i(17),n=i(24),r=i(19),c=i(20),a=i(43),h=(new n.H,function(e,t){for(var i=0;i<e;i++)t(i)}),d=n.p;function l(e,t){return Math.random()*(t-e)+e}var u=function(){return new n.H(l(-1,1),l(-1,1),l(-1,1)).normalize()},p=function(e){return l(0,1)<e},f=function(){return new n.H(5e3,5e3,5e3)},v=function(e){return void 0===e||null===e},m=function(e,t){if(v(e))throw new b(t);return e},b=function(e){Object(r.a)(i,e);var t=Object(c.a)(i);function i(e){return Object(o.a)(this,i),t.call(this,null!==e&&void 0!==e?e:"Unexpected nil value!")}return i}(Object(a.a)(Error)),w=function(){},j=function(e){return e.values().next().value},g=function e(){var t=this;Object(o.a)(this,e),this.mesh=void 0,this.createStarsGeometry=function(){var e=new n.d,t=[];return h(1e3,(function(e){var i=d.randFloat(100,500);t.push(d.randFloat(-1,1)*i,d.randFloat(-1,1)*i,d.randFloat(-1,1)*i)})),e.setAttribute("position",new n.k(t,3)),e},this.mesh=new n.n,[new n.w({color:5592405,size:2,sizeAttenuation:!1}),new n.w({color:5592405,size:1,sizeAttenuation:!1}),new n.w({color:3355443,size:2,sizeAttenuation:!1}),new n.w({color:3815994,size:1,sizeAttenuation:!1}),new n.w({color:1710618,size:2,sizeAttenuation:!1}),new n.w({color:1710618,size:1,sizeAttenuation:!1})].forEach((function(e){var i=t.createStarsGeometry(),s=new n.v(i,e);s.matrixAutoUpdate=!1,s.updateMatrix(),t.mesh.add(s)}))},O=function e(t,i){var s=this;Object(o.a)(this,e),this.followedObject=t,this.shape=void 0,this.hitboxDebug=void 0,this.debug=function(e){var t=new n.C(s.shape.radius,8,6),i=new n.r({color:3296424,wireframe:!0});s.hitboxDebug=new n.q(t,i),e.add(s.hitboxDebug),s.update()},this.update=function(){var e=s.followedObject.position.clone();s.shape.center.copy(e),v(s.hitboxDebug)||s.hitboxDebug.position.copy(e)},this.intersects=function(e){return s.shape.intersectsSphere(e.shape)};var r=i.clone();r.computeBoundingSphere(),this.shape=m(r.boundingSphere),this.hitboxDebug=null,this.update()},y=function e(){Object(o.a)(this,e),this.shape=new n.B(f(),0),this.intersects=function(e){return!1}};function k(e,t,i,s,o){return n.p.mapLinear(e,t,i,s,o)}function x(e){return function(e,t,i){return e<t?t:e>i?i:e}(e,0,1)}var S,E=function e(t){var i=this;Object(o.a)(this,e),this.clock=t,this.mesh=void 0,this.hitbox=void 0,this.update=function(){var e=i.clock.getElapsed(),t=k(Math.sin(10*e),-1,1,.99,1.01);i.mesh.scale.set(t,t,t)},this.mesh=new n.n;var s=new n.C(5,16,12),r=new n.r({color:16395051,wireframe:!0}),c=new n.q(s,r);this.mesh.add(c),this.hitbox=new O(this.mesh,s)},M=i(26);!function(e){e.up="up",e.down="down",e.left="left",e.right="right",e.forwards="forwards",e.backwards="backwards",e.rollLeft="rollLeft",e.rollRight="rollRight",e.shoot="shoot"}(S||(S={}));var G=function(){var e;return e={},Object(M.a)(e,S.up,0),Object(M.a)(e,S.down,0),Object(M.a)(e,S.left,0),Object(M.a)(e,S.right,0),Object(M.a)(e,S.forwards,0),Object(M.a)(e,S.backwards,0),Object(M.a)(e,S.rollLeft,0),Object(M.a)(e,S.rollRight,0),Object(M.a)(e,S.shoot,0),e},z=function e(){var t=this;Object(o.a)(this,e),this.moveState=void 0,this.keyMapping=void 0,this.bindKey=function(e,i){t.keyMapping.set(e,i),t.moveState=G()},this.attachListeners=function(){window.addEventListener("keydown",t.keyDownHandler),window.addEventListener("keyup",t.keyUpHandler)},this.dispose=function(){window.addEventListener("keydown",t.keyDownHandler),window.addEventListener("keyup",t.keyUpHandler)},this.keyDownHandler=function(e){var i=t.keyMapping.get(e.code);v(i)||(t.moveState[i]=1)},this.keyUpHandler=function(e){var i=t.keyMapping.get(e.code);v(i)||(t.moveState[i]=0)},this.moveState=G(),this.keyMapping=function(){var e=new Map;return e.set("KeyW",S.up),e.set("KeyS",S.down),e.set("KeyA",S.left),e.set("KeyD",S.right),e.set("KeyI",S.forwards),e.set("KeyK",S.backwards),e.set("KeyJ",S.rollLeft),e.set("KeyL",S.rollRight),e.set("Space",S.shoot),e}()},H=function e(){var t=this;Object(o.a)(this,e),this.clock=void 0,this.delta=void 0,this.elapsed=void 0,this.getDelta=function(){return t.delta},this.getElapsed=function(){return t.elapsed},this.tick=function(){t.delta=t.clock.getDelta(),t.elapsed=t.clock.getElapsedTime()},this.clock=new n.e,this.delta=0,this.elapsed=0},D=function e(t,i,s,r){var c=this;Object(o.a)(this,e),this.controls=t,this.object=i,this.shots=s,this.clock=r,this.moveState=void 0,this.shotDelta=void 0,this.orbitSpeed=void 0,this.rollSpeed=void 0,this.forwardsAndBackwardsSpeed=void 0,this.inertiaFactor=void 0,this.shotRecoveryTime=void 0,this.update=function(){c.moveState=function(e,t,i){var s;return s={},Object(M.a)(s,S.up,d.lerp(e[S.up],t[S.up],i)),Object(M.a)(s,S.down,d.lerp(e[S.down],t[S.down],i)),Object(M.a)(s,S.left,d.lerp(e[S.left],t[S.left],i)),Object(M.a)(s,S.right,d.lerp(e[S.right],t[S.right],i)),Object(M.a)(s,S.forwards,d.lerp(e[S.forwards],t[S.forwards],i)),Object(M.a)(s,S.backwards,d.lerp(e[S.backwards],t[S.backwards],i)),Object(M.a)(s,S.rollLeft,d.lerp(e[S.rollLeft],t[S.rollLeft],i)),Object(M.a)(s,S.rollRight,d.lerp(e[S.rollRight],t[S.rollRight],i)),Object(M.a)(s,S.shoot,t[S.shoot]),s}(c.moveState,c.controls.moveState,c.inertiaFactor),c.updateDepth(),c.updateOrbit(),c.updateShots()},this.updateDepth=function(){var e=c.moveState[S.backwards]-c.moveState[S.forwards];if(Math.abs(e)>1e-5){var t=e*c.forwardsAndBackwardsSpeed,i=c.object.position.length();i+t<15?i=15:i+t>50?i=50:i+=t,c.object.position.setLength(i)}},this.updateOrbit=function(){var e=new n.H,t=new n.H,i=new n.H;c.object.matrix.extractBasis(e,t,i);var s=c.moveState[S.up]-c.moveState[S.down],o=c.moveState[S.right]-c.moveState[S.left],r=e.clone();r.multiplyScalar(s);var a=t.clone();a.multiplyScalar(o);var h=(new n.H).addVectors(r,a).clampLength(0,1),d=h.length();d>1e-5&&(h.normalize(),c.object.position.applyAxisAngle(h,d*c.orbitSpeed));var l=c.moveState[S.rollRight]-c.moveState[S.rollLeft];t.applyAxisAngle(i,l*c.rollSpeed),c.object.up.copy(t),c.object.lookAt(0,0,0)},this.updateShots=function(){c.shotDelta+=c.clock.getDelta(),c.shotDelta>c.shotRecoveryTime&&1===c.moveState[S.shoot]&&(c.shotDelta=0,c.shots.spawn(c.object.position))},this.moveState=G(),this.shotDelta=0,this.orbitSpeed=.05,this.rollSpeed=.05,this.forwardsAndBackwardsSpeed=.5,this.inertiaFactor=.1,this.shotRecoveryTime=.15,this.update()},R=function e(t){var i=this;Object(o.a)(this,e),this.effects=t,this.mesh=void 0,this.hitbox=void 0,this.update=function(){i.hitbox.update()},this.onCollide=function(e){i.effects.glitch()},this.createGeometry=function(){var e=new n.d,t=[0,0,1],i=[0,.25,0],s=[-.5,-.25,0],o=[.5,-.25,0],r=new Float32Array([].concat(t,i,s,t,i,o,t,s,o,i,s,o));return e.setAttribute("position",new n.c(r,3)),e};var s=this.createGeometry(),r=new n.r({color:16448250,wireframe:!0});this.mesh=new n.q(s,r),this.mesh.position.set(0,0,50),this.hitbox=new O(this.mesh,s)},A=function(e){Object(r.a)(i,e);var t=Object(c.a)(i);function i(){var e;return Object(o.a)(this,i),(e=t.call(this,75,window.innerWidth/window.innerHeight,.1,1e3)).distance=void 0,e.inertiaFactor=void 0,e.followedObject=void 0,e.follow=function(t){e.followedObject=t,e.update()},e.update=function(){var t=e.followedObject.position.clone();t.add(t.clone().normalize().multiplyScalar(e.distance));var i=(new n.H).lerpVectors(e.position,t,e.inertiaFactor);e.position.copy(i),e.up.copy(e.followedObject.up),e.lookAt(0,0,0)},e.distance=2,e.inertiaFactor=.8,e.followedObject=new n.s,e}return i}(n.u),P=function e(){var t=this;Object(o.a)(this,e),this.renderer=void 0,this.getRenderer=function(){return t.renderer},this.getDomElement=function(){return t.renderer.domElement},this.resize=function(){t.renderer.setSize(window.innerWidth,window.innerHeight)},this.renderer=new n.J,this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.toneMappingExposure=Math.pow(1.01,4),this.renderer.outputEncoding=n.K},L=i(25);function F(e){return"geometry"in e&&"material"in e}var C=function e(){var t=this;Object(o.a)(this,e),this.scene=void 0,this.add=function(){var e;return(e=t.scene).add.apply(e,arguments)},this.remove=function(){var e;return(e=t.scene).remove.apply(e,arguments)},this.dispose=function(){t.scene.traverse((function(e){e&&(F(e)&&(e.geometry&&e.geometry.dispose(),function(e){if(F(e)){var t,i=[].concat(e.material),s=Object(L.a)(i);try{for(s.s();!(t=s.n()).done;){t.value.dispose()}}catch(o){s.e(o)}finally{s.f()}}}(e)),Promise.resolve().then((function(){e.parent&&e.parent.remove(e)})))}))},this.scene=new n.z,this.scene.fog=new n.m(0,25e-6);var i=new n.b(16777215);this.scene.add(i)},I=function e(t,i,s,r){var c=this;Object(o.a)(this,e),this.clock=i,this.explosions=s,this.dropObject=r,this.mesh=void 0,this.hitbox=void 0,this.normal=void 0,this.angularVelocity=void 0,this.radialVelocity=void 0,this.epoch=void 0,this.spawn=function(e,t){c.mesh.position.copy(e),c.normal=t,c.epoch=c.clock.getElapsed()},this.onCollide=function(e){c.drop()},this.update=function(){var e=c.clock.getDelta(),t=function(e){var t=2*Math.PI/3;return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin((10*e-.75)*t)+1}(x(k(c.clock.getElapsed()-c.epoch,0,1,0,1)));c.mesh.scale.set(t,t,t);var i=c.angularVelocity*e;c.mesh.position.applyAxisAngle(c.normal,i);var s=c.mesh.position.length(),o=c.radialVelocity*e;c.mesh.position.setLength(s+o),c.hitbox.update(),c.mesh.position.length()>50&&c.drop()},this.drop=function(){c.explosions.spawn(c.mesh.position.clone()),c.dropObject(c)},this.mesh=t.buildMesh(),this.hitbox=new O(this.mesh,t.getHitboxGeometry()),this.normal=new n.H(0,1,0),this.angularVelocity=1,this.radialVelocity=1,this.epoch=0};var T,q=function e(){var t=this;Object(o.a)(this,e),this.mesh=void 0,this.hitboxGeometry=void 0,this.buildMesh=function(){return t.mesh.clone()},this.getHitboxGeometry=function(){return t.hitboxGeometry.clone()},this.hitboxGeometry=new n.j(1.5);var i=new n.r({color:2882091,wireframe:!0});this.mesh=new n.q(this.hitboxGeometry,i)},K=i(4);!function(e){e[e.asteroids=0]="asteroids",e[e.ship=1]="ship",e[e.shots=2]="shots",e[e.missiles=3]="missiles",e[e.center=4]="center"}(T||(T={}));var V=function e(){var t,i=this;Object(o.a)(this,e),this.rules=void 0,this.groups=void 0,this.addRule=function(e,t){i.rules.add([e,t])},this.addObjectToGroup=function(e,t){i.groups[t].add(e)},this.removeObjectFromGroup=function(e,t){i.groups[t].delete(e)},this.update=function(){i.rules.forEach((function(e){var t=Object(K.a)(e,2),s=t[0],o=t[1];i.groups[s].forEach((function(e){i.groups[o].forEach((function(t){var i,s;W(e,t)&&(null===(i=e.onCollide)||void 0===i||i.call(e,t),null===(s=t.onCollide)||void 0===s||s.call(t,e))}))}))}))},this.rules=new Set,this.groups=(t={},Object(M.a)(t,T.asteroids,new Set),Object(M.a)(t,T.ship,new Set),Object(M.a)(t,T.shots,new Set),Object(M.a)(t,T.missiles,new Set),Object(M.a)(t,T.center,new Set),t)},W=function(e,t){return e.hitbox.intersects(t.hitbox)},B=function e(t,i,s,r){var c=this;Object(o.a)(this,e),this.scene=t,this.collider=i,this.clock=s,this.explosions=r,this.idleObjects=void 0,this.liveObjects=void 0,this.intervalId=void 0,this.start=function(){c.intervalId=setInterval(c.spawnRandom,3e3)},this.spawn=function(e,t){var i=m(j(c.idleObjects));c.idleObjects.delete(i),c.liveObjects.add(i),i.spawn(e,t),c.collider.addObjectToGroup(i,T.asteroids)},this.drop=function(e){e.mesh.position.copy(f()),c.liveObjects.delete(e),c.idleObjects.add(e),c.collider.removeObjectFromGroup(e,T.asteroids)},this.update=function(){c.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){c.liveObjects.forEach((function(e){return c.scene.remove(e.mesh)})),c.idleObjects.forEach((function(e){return c.scene.remove(e.mesh)})),null!==c.intervalId&&clearTimeout(c.intervalId)},this.spawnRandom=function(){var e=u(),t=function(e){var t=new n.H(1,0,0),i=[new n.H(0,1,0),new n.H(0,0,1)].reduce((function(t,i){return e.dot(t)>e.dot(i)?i:t}),t);return p(.5)&&i.negate(),(new n.H).crossVectors(e,i)}(e).setLength(5);c.spawn(t,e)},this.idleObjects=new Set,this.liveObjects=new Set;var a=new q;h(50,(function(e){var t=new I(a,c.clock,c.explosions,c.drop);t.mesh.position.copy(f()),c.idleObjects.add(t)})),this.idleObjects.forEach((function(e){return c.scene.add(e.mesh)})),this.intervalId=null},U=function e(t,i,s,r,c){var a=this;Object(o.a)(this,e),this.object=t,this.clock=i,this.explosions=s,this.dropObject=c,this.mesh=void 0,this.hitbox=void 0,this.direction=void 0,this.angSpeed=void 0,this.speed=void 0,this.epoch=void 0,this.spawn=function(e,t){a.epoch=a.clock.getElapsed(),a.mesh.position.copy(e),a.direction.copy(t),a.direction.normalize(),a.align()},this.update=function(){a.updateRotation(),a.updatePosition(),a.updateFlames(),a.hitbox.update(),a.clock.getElapsed()-a.epoch>7&&a.drop()},this.onCollide=function(e){a.drop()},this.updateRotation=function(){var e=a.clock.getDelta(),t=a.object.position.clone();t.sub(a.mesh.position);var i=a.direction.angleTo(t),s=d.clamp(i,-a.angSpeed*e,a.angSpeed*e),o=(new n.H).crossVectors(t,a.direction);o.normalize(),a.direction.applyAxisAngle(o,-s),a.align()},this.updatePosition=function(){var e=a.clock.getDelta(),t=a.direction.clone();t.multiplyScalar(a.speed*e),a.mesh.position.add(t)},this.updateFlames=function(){var e=a.clock.getDelta(),t=a.clock.getElapsed();a.mesh.children[0].scale.y+=.05*Math.sin(10*t),a.mesh.children[0].rotateY(10*e),a.mesh.children[1].scale.y-=.05*Math.cos(10*t),a.mesh.children[1].rotateY(10*e)},this.align=function(){var e=a.mesh.position.clone();e.add(a.direction),a.mesh.lookAt(e),a.mesh.rotateOnAxis(new n.H(1,0,0),.5*Math.PI)},this.drop=function(){a.explosions.spawn(a.mesh.position.clone()),a.dropObject(a)},this.angSpeed=3,this.speed=40,this.mesh=r.buildMesh(),this.direction=u(),this.hitbox=new O(this.mesh,r.getHitboxGeometry()),this.epoch=0},J=function e(){var t=this;Object(o.a)(this,e),this.mesh=void 0,this.hitboxGeometry=void 0,this.buildMesh=function(){return t.mesh.clone()},this.getHitboxGeometry=function(){return t.hitboxGeometry.clone()},this.hitboxGeometry=new n.h(.2,.4,1,6,1);var i=new n.r({wireframe:!0,color:16777215}),s=new n.g(.3,1,6),r=new n.r({wireframe:!0,color:15658100}),c=new n.r({wireframe:!0,color:15618359}),a=new n.q(s,r),h=new n.q(s,c);a.position.y-=1,h.position.y-=1,a.rotateX(Math.PI),h.rotateX(Math.PI),this.mesh=new n.q(this.hitboxGeometry,i),this.mesh.add(a),this.mesh.add(h)},X=function e(t,i,s,r,c){var a=this;Object(o.a)(this,e),this.scene=t,this.clock=s,this.collider=r,this.idleObjects=void 0,this.liveObjects=void 0,this.intervalId=void 0,this.start=function(){var e=new n.H(0,0,0);a.spawn(e,u()),a.intervalId=setInterval((function(){return a.spawn(e,u())}),1e4)},this.spawn=function(e,t){var i=m(j(a.idleObjects));a.idleObjects.delete(i),a.liveObjects.add(i),i.spawn(e,t),a.collider.addObjectToGroup(i,T.missiles)},this.drop=function(e){e.mesh.position.copy(f()),a.liveObjects.delete(e),a.idleObjects.add(e),a.collider.removeObjectFromGroup(e,T.missiles)},this.update=function(){a.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){a.liveObjects.forEach((function(e){return a.scene.remove(e.mesh)})),a.idleObjects.forEach((function(e){return a.scene.remove(e.mesh)})),null!==a.intervalId&&clearInterval(a.intervalId)},this.idleObjects=new Set,this.liveObjects=new Set;var d=new J;h(50,(function(e){var t=new U(i,a.clock,c,d,a.drop);t.mesh.position.copy(f()),a.idleObjects.add(t)})),this.idleObjects.forEach((function(e){return a.scene.add(e.mesh)})),this.intervalId=null},Y=function e(t,i,s){var n=this;Object(o.a)(this,e),this.clock=i,this.dropObject=s,this.mesh=void 0,this.hitbox=void 0,this.speed=void 0,this.spawn=function(e){n.mesh.position.copy(e)},this.onCollide=function(e){n.drop()},this.update=function(){var e=n.clock.getDelta(),t=n.mesh.position.length(),i=n.speed*e;n.mesh.position.setLength(t-i),n.hitbox.update(),n.mesh.position.length()<=5&&n.drop()},this.drop=function(){n.dropObject(n)},this.mesh=t.buildMesh(),this.hitbox=new O(this.mesh,t.getHitboxGeometry()),this.speed=200},N=function e(){var t=this;Object(o.a)(this,e),this.mesh=void 0,this.hitboxGeometry=void 0,this.buildMesh=function(){return t.mesh.clone()},this.getHitboxGeometry=function(){return t.hitboxGeometry.clone()};var i=new n.j(.15),s=new n.r({color:16773998,wireframe:!0}),r=new n.q(i,s);this.hitboxGeometry=new n.j(.3);var c=new n.r({color:14058496,wireframe:!0});this.mesh=new n.q(this.hitboxGeometry,c),this.mesh.add(r)},Z=function e(t,i,s,n){var r=this;Object(o.a)(this,e),this.scene=t,this.collider=i,this.clock=s,this.sounds=n,this.idleObjects=void 0,this.liveObjects=void 0,this.spawn=function(e){var t=m(j(r.idleObjects));r.idleObjects.delete(t),r.liveObjects.add(t),t.spawn(e),r.collider.addObjectToGroup(t,T.shots),r.sounds.playShot()},this.drop=function(e){e.mesh.position.copy(f()),r.liveObjects.delete(e),r.idleObjects.add(e),r.collider.removeObjectFromGroup(e,T.shots)},this.update=function(){r.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){r.liveObjects.forEach((function(e){return r.scene.remove(e.mesh)})),r.idleObjects.forEach((function(e){return r.scene.remove(e.mesh)}))},this.idleObjects=new Set,this.liveObjects=new Set;var c=new N;h(20,(function(e){var t=new Y(c,r.clock,r.drop);t.mesh.position.copy(f()),r.idleObjects.add(t)})),this.idleObjects.forEach((function(e){return r.scene.add(e.mesh)}))},Q=i(18),$=function(){function e(t,i,s){var n=this;Object(o.a)(this,e),this.clock=i,this.dropObject=s,this.hitbox=void 0,this.explosionMesh=void 0,this.epoch=void 0,this.fragmentSpeeds=void 0,this.spawn=function(e){n.mesh.position.copy(e),n.epoch=n.clock.getElapsed(),n.fragmentSpeeds=n.getRandomSpeeds(),n.explosionMesh.traverseFragments((function(e){e.setRadiusToCenter(.1)}))},this.onCollide=w,this.update=function(){var e=n.clock.getElapsed(),t=n.clock.getDelta(),i=e-n.epoch;n.explosionMesh.traverseFragments((function(e,i){var s=n.fragmentSpeeds[i];e.extendRadius(t*s)}));var s=x(k(i,0,1,0,1));n.explosionMesh.updateMaterial(s),i>1&&n.drop()},this.getRandomSpeeds=function(){var e=[];return n.explosionMesh.traverseFragments((function(t){var i=l(2.5,5);e.push(i)})),e},this.drop=function(){n.dropObject(n)},this.explosionMesh=t.buildMesh(),this.hitbox=new y,this.epoch=0,this.fragmentSpeeds=this.getRandomSpeeds()}return Object(Q.a)(e,[{key:"mesh",get:function(){return this.explosionMesh.mesh}}]),e}(),_=new n.f(16777110),ee=new n.f(6357504),te=function e(t){var i=this;Object(o.a)(this,e),this.mesh=void 0,this.setPosition=function(e,t,s){i.mesh.position.set(e,t,s)},this.setRadiusToCenter=function(e){i.mesh.position.setLength(e)},this.extendRadius=function(e){var t=i.mesh.position.clone().setLength(e);i.mesh.position.add(t)};var s=l(.25,1),r=new n.E(s);this.mesh=new n.q(r,t)},ie=function e(){var t=this;Object(o.a)(this,e),this.mesh=void 0,this.fragments=void 0,this.fragmentMaterial=void 0,this.traverseFragments=function(e){t.fragments.forEach((function(t,i){return e(t,i)}))},this.updateMaterial=function(e){var i=1-e,s=new n.f(_).lerp(ee,e);t.fragmentMaterial.opacity=i,t.fragmentMaterial.color=s},this.buildFragments=function(){for(var e=new n.D(.1,6,6).getAttribute("position"),i=[],s=0;s<e.count;s++){var o=e.getX(s),r=e.getY(s),c=e.getZ(s),a=new te(t.fragmentMaterial);a.setPosition(o,r,c),t.mesh.add(a.mesh),i.push(a)}return i},this.mesh=new n.q,this.fragmentMaterial=new n.r({color:_,wireframe:!0,transparent:!0}),this.fragments=this.buildFragments();var i=l(0,2*Math.PI);this.mesh.rotateOnAxis(u(),i)},se=function e(){Object(o.a)(this,e),this.buildMesh=function(){return new ie}},oe=function e(t,i){var s=this;Object(o.a)(this,e),this.scene=t,this.clock=i,this.idleObjects=void 0,this.liveObjects=void 0,this.spawn=function(e){var t=m(j(s.idleObjects));s.idleObjects.delete(t),s.liveObjects.add(t),t.spawn(e)},this.drop=function(e){e.mesh.position.copy(f()),s.liveObjects.delete(e),s.idleObjects.add(e)},this.update=function(){s.liveObjects.forEach((function(e){return e.update()}))},this.dispose=function(){s.liveObjects.forEach((function(e){return s.scene.remove(e.mesh)})),s.idleObjects.forEach((function(e){return s.scene.remove(e.mesh)}))},this.idleObjects=new Set,this.liveObjects=new Set;var n=new se;h(50,(function(e){var t=new $(n,s.clock,s.drop);t.mesh.position.copy(f()),s.idleObjects.add(t)})),this.idleObjects.forEach((function(e){return s.scene.add(e.mesh)}))},ne=(i(42),function e(){Object(o.a)(this,e),this.playShot=w,this.playPickup=w,this.dispose=w}),re=i(44),ce=i(46),ae=i(41),he=i(45),de=function e(){Object(o.a)(this,e)};de.after=function(e,t){var i=setTimeout(t,e);return function(){clearTimeout(i)}};var le=function e(t,i,s){var n=this;Object(o.a)(this,e),this.composer=void 0,this.renderer=void 0,this.renderPass=void 0,this.bloomPass=void 0,this.glitchPass=void 0,this.glitch=function(){n.glitchPass.trigger()},this.resize=function(){var e=window.innerWidth,t=window.innerHeight;n.renderPass.setSize(e,t),n.bloomPass.setSize(e,t),n.glitchPass.setSize(e,t),n.composer.setSize(e,t),n.renderer.setSize(e,t)},this.render=function(){n.composer.render()},this.renderer=t.getRenderer(),this.renderPass=new ae.a(i.scene,s),this.bloomPass=new ve,this.glitchPass=new me,this.composer=new re.a(this.renderer),this.composer.addPass(this.renderPass),this.composer.addPass(this.bloomPass),this.composer.addPass(this.glitchPass),this.composer.renderToScreen=!0},ue=1.1,pe=0,fe=0,ve=function(e){Object(r.a)(i,e);var t=Object(c.a)(i);function i(){return Object(o.a)(this,i),t.call(this,new n.G(window.innerWidth,window.innerHeight),ue,fe,pe)}return i}(he.a),me=function(e){Object(r.a)(i,e);var t=Object(c.a)(i);function i(){var e;return Object(o.a)(this,i),(e=t.call(this)).cancelGlitch=void 0,e.trigger=function(){e.cancelGlitch(),e.enabled=!0,e.cancelGlitch=de.after(750,(function(){e.enabled=!1}))},e.goWild=!0,e.enabled=!1,e.cancelGlitch=w,e}return i}(ce.a),be=function e(){var t=this;Object(o.a)(this,e),this.renderer=void 0,this.clock=void 0,this.camera=void 0,this.keyboardControls=void 0,this.objectController=void 0,this.center=void 0,this.ship=void 0,this.scene=void 0,this.effects=void 0,this.explosions=void 0,this.asteroids=void 0,this.missiles=void 0,this.shots=void 0,this.collider=void 0,this.sounds=void 0,this.start=function(){var e;t.keyboardControls.attachListeners(),window.addEventListener("resize",t.resize),t.asteroids.start(),t.missiles.start(),e="Game started!",console.log("%c".concat(e),"\n        background-color: #dadada;\n        color: #2b2bfa;\n        margin: 1em;\n        padding: 0.5em 1em;\n        border-radius: 9999px;\n        font-size: 14px;\n        text-align: center;\n        font-weight: 800;\n    "),t.animate()},this.dispose=function(){t.keyboardControls.dispose(),t.asteroids.dispose(),t.missiles.dispose(),t.explosions.dispose(),t.sounds.dispose(),t.scene.dispose(),window.removeEventListener("resize",t.resize)},this.getDomElement=function(){return t.renderer.getDomElement()},this.resize=function(){t.effects.resize(),t.camera.aspect=window.innerWidth/window.innerHeight,t.camera.updateProjectionMatrix()},this.animate=function(){t.clock.tick(),t.objectController.update(),t.ship.update(),t.center.update(),t.missiles.update(),t.asteroids.update(),t.shots.update(),t.explosions.update(),t.collider.update(),t.camera.update(),t.effects.render(),requestAnimationFrame(t.animate)},this.scene=new C,this.camera=new A,this.renderer=new P,this.clock=new H,this.collider=new V,this.collider.addRule(T.asteroids,T.ship),this.collider.addRule(T.shots,T.asteroids),this.collider.addRule(T.shots,T.center),this.collider.addRule(T.shots,T.missiles),this.collider.addRule(T.missiles,T.ship),this.sounds=new ne,this.explosions=new oe(this.scene,this.clock),this.effects=new le(this.renderer,this.scene,this.camera),this.effects.resize(),this.ship=new R(this.effects),this.collider.addObjectToGroup(this.ship,T.ship),this.camera.follow(this.ship.mesh);var i=new g;this.center=new E(this.clock),this.collider.addObjectToGroup(this.center,T.center),this.scene.add(this.ship.mesh,i.mesh,this.center.mesh),this.asteroids=new B(this.scene,this.collider,this.clock,this.explosions),this.missiles=new X(this.scene,this.ship.mesh,this.clock,this.collider,this.explosions),this.shots=new Z(this.scene,this.collider,this.clock,this.sounds),this.keyboardControls=new z,this.objectController=new D(this.keyboardControls,this.ship.mesh,this.shots,this.clock)};var we=function(){var e=function(e){var t=Object(s.useRef)(null);return null===t.current&&(t.current=e()),t.current}((function(){return new be}));Object(s.useEffect)((function(){return e.start(),function(){return e.dispose()}}),[e]);return function(t){m(t).appendChild(e.getDomElement())}};t.default=function(){var e=we();return(s.createElement("div",{className:"game-container",ref:e}))}}}]);
//# sourceMappingURL=4.a799a931.chunk.js.map